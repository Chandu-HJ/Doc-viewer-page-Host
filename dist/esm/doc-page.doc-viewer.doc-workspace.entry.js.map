{"version":3,"file":"doc-page.doc-viewer.doc-workspace.entry.js","sources":["src/components/doc-page/doc-page.css?tag=doc-page","src/components/doc-page/doc-page.tsx","src/utils/history.ts","src/components/doc-viewer/doc-viewer.css?tag=doc-viewer","src/components/doc-viewer/doc-viewer.tsx","src/components/doc-workspace/doc-workspace.css?tag=doc-workspace","src/components/doc-workspace/doc-workspace.tsx"],"sourcesContent":["/* src/components/doc-page/doc-page.css */\r\n\r\n/* Wrapper around each rendered page (PDF / image / text) */\r\n.page-wrapper {\r\n  margin: 24px auto;\r\n  position: relative;\r\n  width: fit-content;\r\n  max-width: 100%;\r\n}\r\n\r\n/* pdf.js page container */\r\n.pdfViewerPage .page {\r\n  position: relative;\r\n  border-radius: 16px;\r\n  overflow: hidden;\r\n\r\n  /* Glass card look on page */\r\n  box-shadow: 0 18px 40px rgba(0, 0, 0, 0.35);\r\n  background: radial-gradient(circle at top left, #ffffff 0%, #f3f3f3 40%, #e4e4e4 100%);\r\n}\r\n\r\n/* Highlight overlay (annotations layer) */\r\n.annotationLayer {\r\n  position: absolute;\r\n  inset: 0;\r\n  z-index: 20;\r\n  pointer-events: auto;\r\n}\r\n\r\n/* Highlight rectangles (glass neon) */\r\n.annotationRect {\r\n  position: absolute;\r\n  background: radial-gradient(circle at top left,\r\n    rgba(255, 255, 170, 0.55),\r\n    rgba(255, 210, 90, 0.35));\r\n  border-radius: 6px;\r\n  box-shadow:\r\n    0 0 0 1px rgba(255, 250, 200, 0.5),\r\n    0 0 18px rgba(255, 255, 150, 0.6);\r\n  pointer-events: none;\r\n}\r\n\r\n/* Comment / note icons */\r\n.comment-icon,\r\n.note-icon {\r\n  position: absolute;\r\n  font-size: 18px;\r\n  cursor: pointer;\r\n  z-index: 30;\r\n  user-select: none;\r\n\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n\r\n  width: 28px;\r\n  height: 28px;\r\n  border-radius: 999px;\r\n  backdrop-filter: blur(10px);\r\n  -webkit-backdrop-filter: blur(10px);\r\n\r\n  background: radial-gradient(circle at top left,\r\n    rgba(0, 180, 255, 0.9),\r\n    rgba(90, 70, 250, 0.9));\r\n  box-shadow:\r\n    0 6px 16px rgba(0, 0, 0, 0.35),\r\n    0 0 12px rgba(0, 184, 255, 0.7);\r\n\r\n  color: #fdfdfd;\r\n  transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;\r\n}\r\n\r\n.note-icon {\r\n  background: radial-gradient(circle at top left,\r\n    rgba(255, 140, 80, 0.95),\r\n    rgba(255, 77, 77, 0.95));\r\n  box-shadow:\r\n    0 6px 16px rgba(0, 0, 0, 0.35),\r\n    0 0 12px rgba(255, 130, 80, 0.8);\r\n}\r\n\r\n.comment-icon:hover,\r\n.note-icon:hover {\r\n  transform: translateY(-2px) scale(1.04);\r\n  box-shadow:\r\n    0 10px 28px rgba(0, 0, 0, 0.45),\r\n    0 0 16px rgba(0, 200, 255, 0.9);\r\n}\r\n\r\n/* Ensure text layer does not block clicks */\r\n\r\n\r\n\r\n.virtual-page-wrapper {\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n/* ================================\r\n   NOTE TEXT BUBBLE (PREVIEW)\r\n================================ */\r\n\r\n.note-bubble {\r\n  position: absolute;\r\n  max-width: 240px;\r\n  padding: 10px 14px;\r\n  font-size: 13px;\r\n  border-radius: 12px;\r\n\r\n  background: rgba(255, 250, 240, 0.92);\r\n  backdrop-filter: blur(12px);\r\n  -webkit-backdrop-filter: blur(12px);\r\n\r\n  box-shadow:\r\n    0 4px 18px rgba(0, 0, 0, 0.28),\r\n    0 0 12px rgba(255, 180, 120, 0.6);\r\n\r\n  color: #4b2b1f;\r\n  z-index: 50;\r\n  opacity: 0;\r\n  pointer-events: none;\r\n  transform: translateY(-6px);\r\n  transition: opacity 0.2s ease, transform 0.2s ease;\r\n}\r\n\r\n.note-bubble.visible {\r\n  opacity: 1;\r\n  transform: translateY(0px);\r\n}\r\n\r\n/* Positioning helpers */\r\n.note-bubble.left {\r\n  transform: translate(-110%, -10%);\r\n}\r\n\r\n.note-bubble.right {\r\n  transform: translate(32px, -10%);\r\n}\r\n.note-bubble {\r\n  position: absolute;\r\n  max-width: 240px;\r\n  padding: 10px 14px;\r\n  font-size: 13px;\r\n  border-radius: 12px;\r\n\r\n  background: rgba(255, 250, 240, 0.92);\r\n  backdrop-filter: blur(12px);\r\n  -webkit-backdrop-filter: blur(12px);\r\n\r\n  box-shadow:\r\n    0 4px 18px rgba(0, 0, 0, 0.28),\r\n    0 0 12px rgba(255, 180, 120, 0.6);\r\n\r\n  color: #4b2b1f;\r\n  z-index: 50;\r\n  opacity: 0;\r\n  pointer-events: none;\r\n  transform: translateY(-6px);\r\n  transition: opacity 0.2s ease, transform 0.2s ease;\r\n}\r\n\r\n.note-bubble.visible {\r\n  opacity: 1;\r\n  transform: translateY(0px);\r\n}\r\n\r\n.note-bubble.left {\r\n  transform: translate(-110%, -10%);\r\n}\r\n\r\n.note-bubble.right {\r\n  transform: translate(32px, -10%);\r\n}\r\n.pdfViewerPage.select-mode .textLayer {\r\n  pointer-events: auto !important;\r\n}\r\n","import {\r\n  Component,\r\n  h,\r\n  Prop,\r\n  Element,\r\n  Event,\r\n  EventEmitter,\r\n  Watch,\r\n} from '@stencil/core';\r\nimport { NormalizedRect } from '../../types/annotations';\r\nimport { PageComment, AnnotationKind } from '../../types/comments';\r\n\r\nconst pdfjsLib = (window as any).pdfjsLib;\r\nconst pdfjsViewer = (window as any).pdfjsViewer;\r\n\r\npdfjsLib.GlobalWorkerOptions.workerSrc = '/assets/pdf.worker.js';\r\n\r\n@Component({\r\n  tag: 'doc-page',\r\n  styleUrl: 'doc-page.css',\r\n  shadow: false,\r\n})\r\nexport class DocPage {\r\n  @Element() host!: HTMLElement;\r\n\r\n  @Prop() src!: string;\r\n  @Prop() page!: number;\r\n  @Prop() scale: number = 1.2;\r\n  @Prop() fileType: 'pdf' | 'image' | 'text' = 'pdf';\r\n\r\n  @Prop() activeTool: 'select' | 'highlight' | 'comment' | 'note' = 'select';\r\n\r\n  // readOnly = true ‚Üí no drawing/adding annotations\r\n  @Prop() readOnly: boolean = false;\r\n\r\n  // virtual / lazy rendering flag\r\n  @Prop() visible: boolean = false;\r\n\r\n  @Prop() annotations: NormalizedRect[] = [];\r\n  @Prop() comments: PageComment[] = [];\r\n\r\n  @Event() annotationCreated!: EventEmitter<{ page: number; rect: NormalizedRect }>;\r\n  @Event() commentAddRequested!: EventEmitter<{\r\n    page: number;\r\n    x: number;\r\n    y: number;\r\n    kind: AnnotationKind;\r\n  }>;\r\n  @Event() commentIconClicked!: EventEmitter<{ page: number; commentId: string }>;\r\n\r\n  private viewerContainer!: HTMLDivElement;\r\n  private annotationLayerEl: HTMLElement | null = null;\r\n\r\n  private isDrawing = false;\r\n  private startX = 0;\r\n  private startY = 0;\r\n  private currentRectEl: HTMLElement | null = null;\r\n\r\n  private hasRendered = false; // for lazy load\r\n\r\n  async componentDidLoad() {\r\n    await this.ensureRendered();\r\n  }\r\n\r\n  @Watch('visible')\r\n  async visibleChanged() {\r\n    await this.ensureRendered();\r\n  }\r\n\r\n  @Watch('annotations')\r\n  annotationsChanged() {\r\n    this.redrawHighlightsFromProps();\r\n  }\r\n\r\n  @Watch('comments')\r\n  commentsChanged() {\r\n    this.redrawCommentsFromProps();\r\n  }\r\n\r\n  @Watch('activeTool')\r\n  activeToolChanged() {\r\n    this.updatePointerEvents();\r\n  }\r\n\r\n  @Watch('readOnly')\r\n  readOnlyChanged() {\r\n    this.updatePointerEvents();\r\n  }\r\n\r\n  // ========== LAZY RENDERING ==========\r\n  private async ensureRendered() {\r\n    if (!this.visible) return; // not in viewport yet\r\n    if (this.hasRendered) return; // already rendered once\r\n\r\n    this.hasRendered = true;\r\n\r\n    if (this.fileType === 'image') {\r\n      await this.renderImagePage();\r\n    } else if (this.fileType === 'text') {\r\n      await this.renderTextPage();\r\n    } else {\r\n      await this.renderPdfPage();\r\n    }\r\n  }\r\n\r\n  // ========== RENDER TYPES ==========\r\n  private async renderPdfPage() {\r\n    const loadingTask = pdfjsLib.getDocument(this.src);\r\n    const pdf = await loadingTask.promise;\r\n\r\n    const page = await pdf.getPage(this.page);\r\n    const viewport = page.getViewport({ scale: this.scale });\r\n\r\n    const eventBus = new pdfjsViewer.EventBus();\r\n\r\n    const pageView = new pdfjsViewer.PDFPageView({\r\n      container: this.viewerContainer,\r\n      id: this.page,\r\n      scale: this.scale,\r\n      defaultViewport: viewport,\r\n      eventBus,\r\n      textLayerMode: 2,\r\n    });\r\n\r\n    pageView.setPdfPage(page);\r\n    await pageView.draw();\r\n\r\n    const pageDiv = pageView.div as HTMLElement;\r\n\r\n    // ‚úÖ Make sure layout is fully done before creating annotation layer\r\n    const setup = () => {\r\n      this.setupAnnotationLayer(pageDiv);\r\n      this.redrawHighlightsFromProps();\r\n      this.redrawCommentsFromProps();\r\n    };\r\n\r\n    // double RAF ‚Üí next layout + next paint\r\n    requestAnimationFrame(() => {\r\n      requestAnimationFrame(setup);\r\n    });\r\n  }\r\n\r\n  private async renderImagePage() {\r\n    const pageDiv = document.createElement('div');\r\n    pageDiv.classList.add('page');\r\n    pageDiv.style.position = 'relative';\r\n    this.viewerContainer.appendChild(pageDiv);\r\n\r\n    const img = document.createElement('img');\r\n    img.src = this.src;\r\n    img.style.display = 'block';\r\n    img.style.maxWidth = `${800 * this.scale}px`;\r\n\r\n    pageDiv.appendChild(img);\r\n\r\n    img.onload = () => {\r\n      this.setupAnnotationLayer(pageDiv);\r\n      this.redrawHighlightsFromProps();\r\n      this.redrawCommentsFromProps();\r\n    };\r\n  }\r\n\r\n  private async renderTextPage() {\r\n    const pageDiv = document.createElement('div');\r\n    pageDiv.classList.add('page');\r\n    pageDiv.style.position = 'relative';\r\n    this.viewerContainer.appendChild(pageDiv);\r\n\r\n    const textEl = document.createElement('pre');\r\n    textEl.classList.add('text-content');\r\n    textEl.style.fontSize = `${16 * this.scale}px`;\r\n    textEl.style.whiteSpace = 'pre-wrap';\r\n\r\n    const text = await fetch(this.src).then((r) => r.text());\r\n    textEl.textContent = text;\r\n    pageDiv.appendChild(textEl);\r\n\r\n    this.setupAnnotationLayer(pageDiv);\r\n    this.redrawHighlightsFromProps();\r\n    this.redrawCommentsFromProps();\r\n\r\n    // text highlight uses DOM selection\r\n    textEl.addEventListener('mouseup', () => this.handleTextMouseUp());\r\n  }\r\n\r\n  // ========== ANNOTATION LAYER ==========\r\n  private setupAnnotationLayer(pageDiv: HTMLElement) {\r\n    const old = pageDiv.querySelector('.annotationLayer');\r\n    if (old) old.remove();\r\n\r\n    const layer = document.createElement('div');\r\n    layer.classList.add('annotationLayer');\r\n    Object.assign(layer.style, {\r\n      position: 'absolute',\r\n      inset: '0',\r\n      zIndex: '999', // ensure it is on top of canvas/text\r\n      pointerEvents: 'auto',\r\n    });\r\n\r\n    this.annotationLayerEl = layer;\r\n    pageDiv.appendChild(layer);\r\n\r\n    // Attach mouse handlers for all file types; logic inside onMouseDown handles special cases\r\n    if (!this.readOnly) {\r\n      layer.addEventListener('mousedown', (e) => this.onMouseDown(e));\r\n      layer.addEventListener('mousemove', (e) => this.onMouseMove(e));\r\n      layer.addEventListener('mouseup', () => this.onMouseUp());\r\n    }\r\n\r\n    this.updatePointerEvents();\r\n  }\r\n\r\n  // Centralized control for pointer-events depending on tool + file type\r\n  private updatePointerEvents() {\r\n    if (!this.annotationLayerEl) return;\r\n\r\n    const layer = this.annotationLayerEl;\r\n\r\n    // READ ONLY ‚Üí pass-through except icons\r\n    if (this.readOnly) {\r\n      layer.style.pointerEvents = 'none';\r\n      layer\r\n        .querySelectorAll('.comment-icon, .note-icon')\r\n        .forEach((el) => ((el as HTMLElement).style.pointerEvents = 'auto'));\r\n      return;\r\n    }\r\n\r\n    if (this.fileType === 'text') {\r\n      // TEXT:\r\n      // - highlight/select ‚Üí let text receive events (selection)\r\n      // - comment/note ‚Üí layer must receive click for placement\r\n      if (this.activeTool === 'highlight' || this.activeTool === 'select') {\r\n        layer.style.pointerEvents = 'none';\r\n      } else {\r\n        // comment / note\r\n        layer.style.pointerEvents = 'auto';\r\n      }\r\n    } else {\r\n      // PDF / IMAGE:\r\n      // - select ‚Üí pass-through (no new drawings), icons clickable\r\n      // - others ‚Üí annotation layer active\r\n      if (this.activeTool === 'select') {\r\n        layer.style.pointerEvents = 'none';\r\n      } else {\r\n        layer.style.pointerEvents = 'auto';\r\n      }\r\n    }\r\n\r\n    // Icons should always be clickable\r\n    layer\r\n      .querySelectorAll('.comment-icon, .note-icon')\r\n      .forEach((el) => ((el as HTMLElement).style.pointerEvents = 'auto'));\r\n  }\r\n\r\n  // ========== MOUSE HANDLERS ==========\r\n  private onMouseDown(e: MouseEvent) {\r\n    if (!this.annotationLayerEl || this.readOnly) return;\r\n\r\n    const rect = this.annotationLayerEl.getBoundingClientRect();\r\n    if (!rect.width || !rect.height) return;\r\n\r\n    // COMMENT / NOTE (all file types)\r\n    if (this.activeTool === 'comment' || this.activeTool === 'note') {\r\n      const xNorm = (e.clientX - rect.left) / rect.width;\r\n      const yNorm = (e.clientY - rect.top) / rect.height;\r\n\r\n      this.commentAddRequested.emit({\r\n        page: this.page,\r\n        x: xNorm,\r\n        y: yNorm,\r\n        kind: this.activeTool === 'comment' ? 'comment' : 'note',\r\n      });\r\n      return;\r\n    }\r\n\r\n    // HIGHLIGHT for pdf/image (rectangle drawing)\r\n    if (this.activeTool !== 'highlight' || this.fileType === 'text') return;\r\n\r\n    this.isDrawing = true;\r\n    this.startX = e.clientX - rect.left;\r\n    this.startY = e.clientY - rect.top;\r\n\r\n    this.currentRectEl = document.createElement('div');\r\n    this.currentRectEl.className = 'annotationRect';\r\n    this.currentRectEl.style.left = `${this.startX}px`;\r\n    this.currentRectEl.style.top = `${this.startY}px`;\r\n\r\n    this.annotationLayerEl.appendChild(this.currentRectEl);\r\n  }\r\n\r\n  private onMouseMove(e: MouseEvent) {\r\n    if (this.readOnly) return;\r\n    if (!this.isDrawing || !this.currentRectEl || !this.annotationLayerEl) return;\r\n\r\n    const rect = this.annotationLayerEl.getBoundingClientRect();\r\n    if (!rect.width || !rect.height) return;\r\n\r\n    const x = e.clientX - rect.left;\r\n    const y = e.clientY - rect.top;\r\n\r\n    this.currentRectEl.style.width = `${x - this.startX}px`;\r\n    this.currentRectEl.style.height = `${y - this.startY}px`;\r\n  }\r\n\r\n  private onMouseUp() {\r\n    if (this.readOnly) return;\r\n    if (!this.isDrawing || !this.annotationLayerEl || !this.currentRectEl) return;\r\n\r\n    this.isDrawing = false;\r\n\r\n    const layerRect = this.annotationLayerEl.getBoundingClientRect();\r\n    const width = parseFloat(this.currentRectEl.style.width || '0');\r\n    const height = parseFloat(this.currentRectEl.style.height || '0');\r\n\r\n    if (width > 3 && height > 3 && layerRect.width && layerRect.height) {\r\n      const normalized: NormalizedRect = {\r\n        x: parseFloat(this.currentRectEl.style.left || '0') / layerRect.width,\r\n        y: parseFloat(this.currentRectEl.style.top || '0') / layerRect.height,\r\n        width: width / layerRect.width,\r\n        height: height / layerRect.height,\r\n      };\r\n\r\n      this.annotationCreated.emit({ page: this.page, rect: normalized });\r\n    }\r\n\r\n    this.currentRectEl.remove();\r\n    this.currentRectEl = null;\r\n  }\r\n\r\n  // ========== TEXT HIGHLIGHT ==========\r\n  private handleTextMouseUp() {\r\n    if (this.readOnly) return;\r\n    if (this.fileType !== 'text') return;\r\n    if (this.activeTool !== 'highlight') return;\r\n    if (!this.annotationLayerEl) return;\r\n\r\n    const sel = window.getSelection();\r\n    if (!sel || sel.isCollapsed) return;\r\n\r\n    const range = sel.getRangeAt(0);\r\n    const rect = range.getBoundingClientRect();\r\n    sel.removeAllRanges();\r\n\r\n    const layerRect = this.annotationLayerEl.getBoundingClientRect();\r\n    if (!layerRect.width || !layerRect.height || !rect.width || !rect.height) return;\r\n\r\n    const x = rect.left - layerRect.left;\r\n    const y = rect.top - layerRect.top;\r\n\r\n    const normalized: NormalizedRect = {\r\n      x: x / layerRect.width,\r\n      y: y / layerRect.height,\r\n      width: rect.width / layerRect.width,\r\n      height: rect.height / layerRect.height,\r\n    };\r\n\r\n    const el = document.createElement('div');\r\n    el.className = 'annotationRect';\r\n    el.style.left = `${x}px`;\r\n    el.style.top = `${y}px`;\r\n    el.style.width = `${rect.width}px`;\r\n    el.style.height = `${rect.height}px`;\r\n\r\n    this.annotationLayerEl.appendChild(el);\r\n    this.annotationCreated.emit({ page: this.page, rect: normalized });\r\n  }\r\n\r\n  // ========== REDRAW HIGHLIGHTS ==========\r\n  private redrawHighlightsFromProps() {\r\n    if (!this.annotationLayerEl) return;\r\n\r\n    this.annotationLayerEl.querySelectorAll('.annotationRect').forEach((el) => el.remove());\r\n\r\n    const layerRect = this.annotationLayerEl.getBoundingClientRect();\r\n    if (!layerRect.width || !layerRect.height) return;\r\n\r\n    this.annotations.forEach((a) => {\r\n      const el = document.createElement('div');\r\n      el.className = 'annotationRect';\r\n      el.style.left = `${a.x * layerRect.width}px`;\r\n      el.style.top = `${a.y * layerRect.height}px`;\r\n      el.style.width = `${a.width * layerRect.width}px`;\r\n      el.style.height = `${a.height * layerRect.height}px`;\r\n      this.annotationLayerEl!.appendChild(el);\r\n    });\r\n\r\n    // Ensure icons remain clickable after redraw\r\n    this.updatePointerEvents();\r\n  }\r\n\r\n  // ========== REDRAW COMMENTS + NOTES (WITH NOTE BUBBLE) ==========\r\n  private redrawCommentsFromProps() {\r\n    if (!this.annotationLayerEl) return;\r\n\r\n    // Remove old icons + bubbles\r\n    this.annotationLayerEl\r\n      .querySelectorAll('.comment-icon, .note-icon, .note-bubble')\r\n      .forEach((el) => el.remove());\r\n\r\n    const layerRect = this.annotationLayerEl.getBoundingClientRect();\r\n    if (!layerRect.width || !layerRect.height) return;\r\n\r\n    this.comments.forEach((c) => {\r\n      const isNote = c.kind === 'note';\r\n      const pxX = c.x * layerRect.width;\r\n      const pxY = c.y * layerRect.height;\r\n\r\n      // Create icon\r\n      const icon = document.createElement('div');\r\n      icon.className = isNote ? 'note-icon' : 'comment-icon';\r\n      icon.textContent = isNote ? 'üìù' : 'üí¨';\r\n      icon.style.left = `${pxX}px`;\r\n      icon.style.top = `${pxY}px`;\r\n\r\n      // --- COMMENTS (üí¨) ‚Üí icon only, click = open sidebar\r\n      if (!isNote) {\r\n        icon.addEventListener('click', (ev) => {\r\n          ev.stopPropagation();\r\n          this.commentIconClicked.emit({ page: this.page, commentId: c.id });\r\n        });\r\n        this.annotationLayerEl!.appendChild(icon);\r\n        return;\r\n      }\r\n\r\n      // --- NOTES (üìù) ‚Üí icon + popup text bubble\r\n      const bubble = document.createElement('div');\r\n      bubble.className = 'note-bubble';\r\n      bubble.textContent = c.text && c.text.trim() !== '' ? c.text : '(empty note)';\r\n\r\n      // Place near icon\r\n      bubble.style.left = `${pxX}px`;\r\n      bubble.style.top = `${pxY}px`;\r\n\r\n      // Decide left/right based on available space\r\n      const placeRight = pxX < layerRect.width * 0.6;\r\n      bubble.classList.add(placeRight ? 'right' : 'left');\r\n\r\n      // Hover ‚Üí show\r\n      icon.addEventListener('mouseenter', () => {\r\n        bubble.classList.add('visible');\r\n      });\r\n      icon.addEventListener('mouseleave', () => {\r\n        bubble.classList.remove('visible');\r\n      });\r\n\r\n      // Click ‚Üí toggle + open sidebar\r\n      icon.addEventListener('click', (ev) => {\r\n        ev.stopPropagation();\r\n        bubble.classList.toggle('visible');\r\n        this.commentIconClicked.emit({ page: this.page, commentId: c.id });\r\n      });\r\n\r\n      this.annotationLayerEl!.appendChild(bubble);\r\n      this.annotationLayerEl!.appendChild(icon);\r\n    });\r\n\r\n    // Make sure icons stay clickable\r\n    this.updatePointerEvents();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"page-wrapper\">\r\n        <div\r\n          class=\"pdfViewerPage\"\r\n          ref={(el) => (this.viewerContainer = el as HTMLDivElement)}\r\n        ></div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","// src/utils/history.ts\r\n\r\nexport class HistoryManager<T> {\r\n  private past: T[] = [];\r\n  private future: T[] = [];\r\n\r\n  private clone(state: T): T {\r\n    return JSON.parse(JSON.stringify(state));\r\n  }\r\n\r\n  pushState(state: T) {\r\n    this.past.push(this.clone(state));\r\n    this.future = []; // clear redo stack\r\n  }\r\n\r\n  undo(current: T): T | null {\r\n    if (this.past.length === 0) return null;\r\n    const prev = this.past.pop()!;\r\n    this.future.push(this.clone(current));\r\n    return prev;\r\n  }\r\n\r\n  redo(current: T): T | null {\r\n    if (this.future.length === 0) return null;\r\n    const next = this.future.pop()!;\r\n    this.past.push(this.clone(current));\r\n    return next;\r\n  }\r\n}\r\n","/* =======================================\r\n   THEME VARIABLES\r\n======================================= */\r\n.viewer-container {\r\n  --toolbar-height: 56px;\r\n\r\n  /* LIGHT (pastel glass) */\r\n  --bg-light: linear-gradient(145deg,\r\n    #dffcf4 0%,\r\n    #eaf8ff 40%,\r\n    #f4eaff 100%\r\n  );\r\n  --text-light: #0f1b27;\r\n\r\n  /* DARK (matte mint charcoal) */\r\n  --bg-dark: linear-gradient(145deg,\r\n    #0a1110 0%,\r\n    #080d0c 40%,\r\n    #050908 100%\r\n  );\r\n  --text-dark: #e8f6f3;\r\n\r\n  /* SEPIA (warm cream) */\r\n  --bg-sepia: linear-gradient(145deg,\r\n    #f8efd9 0%,\r\n    #f4e3c3 40%,\r\n    #e7ceaa 100%\r\n  );\r\n  --text-sepia: #3e2a15;\r\n}\r\n\r\n/* =======================================\r\n   MAIN CONTAINER\r\n======================================= */\r\n.viewer-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  width: 100%;\r\n  overflow: hidden;\r\n\r\n  background: var(--bg-light);\r\n  color: var(--text-light);\r\n}\r\n\r\n.viewer-container.theme-dark {\r\n  background: var(--bg-dark);\r\n  color: var(--text-dark);\r\n}\r\n\r\n.viewer-container.theme-sepia {\r\n  background: var(--bg-sepia);\r\n  color: var(--text-sepia);\r\n}\r\n\r\n/* =======================================\r\n   GLASS TOOLBAR\r\n======================================= */\r\n.toolbar {\r\n  height: var(--toolbar-height);\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding: 10px 18px;\r\n\r\n  background: rgba(255, 255, 255, 0.45);\r\n  border-bottom: 1px solid rgba(255, 255, 255, 0.35);\r\n  backdrop-filter: blur(18px);\r\n  -webkit-backdrop-filter: blur(18px);\r\n  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.08);\r\n\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 100;\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .toolbar {\r\n  background: rgba(25, 33, 31, 0.5);\r\n  border-bottom-color: rgba(80, 100, 95, 0.5);\r\n  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.25);\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .toolbar {\r\n  background: rgba(255, 245, 230, 0.55);\r\n  border-bottom-color: rgba(180, 140, 100, 0.4);\r\n}\r\n\r\n/* Inputs */\r\n.toolbar button,\r\n.toolbar select {\r\n  padding: 6px 14px;\r\n  border-radius: 999px;\r\n\r\n  background: rgba(255, 255, 255, 0.65);\r\n  border: 1px solid rgba(255, 255, 255, 0.45);\r\n\r\n  backdrop-filter: blur(12px);\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .toolbar button,\r\n.theme-dark .toolbar select {\r\n  background: rgba(22, 30, 28, 0.7);\r\n  border-color: rgba(100, 120, 110, 0.6);\r\n  color: #e9f7f4;\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .toolbar button,\r\n.theme-sepia .toolbar select {\r\n  background: rgba(255, 245, 230, 0.75);\r\n  border-color: rgba(180, 140, 100, 0.55);\r\n  color: #3d2a15;\r\n}\r\n\r\n/* Active Tool Button */\r\n.toolbar button.active {\r\n  background: #0d9b82;\r\n  color: white;\r\n  border-color: transparent;\r\n  box-shadow: 0 10px 24px rgba(13, 155, 130, 0.35);\r\n}\r\n\r\n/* Active ‚Äì Sepia Accent */\r\n.theme-sepia .toolbar button.active {\r\n  background: #c77a42;\r\n  box-shadow: 0 10px 22px rgba(175, 110, 60, 0.35);\r\n}\r\n\r\n/* =======================================\r\n   MAIN DOCUMENT AREA\r\n======================================= */\r\n.viewer-main {\r\n  display: flex;\r\n  flex: 1;\r\n  overflow: hidden;\r\n  height: calc(100vh - var(--toolbar-height));\r\n}\r\n\r\n.pdf-panel {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: 24px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: flex-start;\r\n\r\n  transition: margin-right 0.25s ease;\r\n}\r\n\r\n/* If sidebar open */\r\n.pdf-panel.has-sidebar {\r\n  margin-right: 330px;\r\n}\r\n\r\n.pages-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 28px;\r\n  width: 100%;\r\n}\r\n\r\n/* =======================================\r\n   SIDEBAR ‚Äî GLASS PANEL\r\n======================================= */\r\n.comment-sidebar {\r\n  width: 330px;\r\n  height: calc(100vh - var(--toolbar-height));\r\n  position: fixed;\r\n  right: 0;\r\n  top: var(--toolbar-height);\r\n\r\n  overflow-y: auto;\r\n  padding-bottom: 16px;\r\n\r\n  background: rgba(255, 255, 255, 0.55);\r\n  border-left: 1px solid rgba(255, 255, 255, 0.35);\r\n\r\n  backdrop-filter: blur(20px);\r\n  -webkit-backdrop-filter: blur(20px);\r\n\r\n  box-shadow: -8px 0 18px rgba(0, 0, 0, 0.15);\r\n  z-index: 200;\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .comment-sidebar {\r\n  background: rgba(25, 33, 31, 0.55);\r\n  border-left-color: rgba(80, 100, 95, 0.4);\r\n  box-shadow: -8px 0 18px rgba(0, 0, 0, 0.32);\r\n  color: #e8f6f3;\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .comment-sidebar {\r\n  background: rgba(255, 245, 230, 0.65);\r\n  border-left-color: rgba(180, 140, 100, 0.45);\r\n}\r\n\r\n/* =======================================\r\n   SIDEBAR CONTENT\r\n======================================= */\r\n.sidebar-header {\r\n  padding: 16px;\r\n  font-weight: 600;\r\n  font-size: 15px;\r\n  border-bottom: 1px solid rgba(255, 255, 255, 0.35);\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .sidebar-header {\r\n  border-bottom-color: rgba(100, 120, 110, 0.35);\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .sidebar-header {\r\n  border-bottom-color: rgba(180, 140, 100, 0.35);\r\n}\r\n\r\n.comment-list {\r\n  padding: 12px;\r\n}\r\n\r\n.comment-item {\r\n  padding: 12px;\r\n  border-radius: 14px;\r\n  background: rgba(255, 255, 255, 0.75);\r\n  border: 1px solid transparent;\r\n  cursor: pointer;\r\n\r\n  transition: 0.15s ease;\r\n}\r\n\r\n/* Hover */\r\n.comment-item:hover {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 8px 18px rgba(13, 155, 130, 0.18);\r\n}\r\n\r\n/* Active */\r\n.comment-item.selected {\r\n  border-color: #0d9b82;\r\n  background: #e1f8f3;\r\n  box-shadow: 0 10px 22px rgba(13, 155, 130, 0.25);\r\n}\r\n\r\n/* Dark selected */\r\n.theme-dark .comment-item.selected {\r\n  background: rgba(30, 45, 42, 0.8);\r\n  border-color: #0d9b82;\r\n}\r\n\r\n/* Sepia selected */\r\n.theme-sepia .comment-item.selected {\r\n  background: #f5e7d2;\r\n  border-color: #c77a42;\r\n}\r\n\r\n/* Editor */\r\n.comment-editor {\r\n  padding: 14px;\r\n  border-top: 1px solid rgba(255, 255, 255, 0.35);\r\n}\r\n\r\n.theme-dark .comment-editor {\r\n  border-top-color: rgba(100, 120, 110, 0.35);\r\n}\r\n\r\n.theme-sepia .comment-editor {\r\n  border-top-color: rgba(180, 140, 100, 0.4);\r\n}\r\n\r\n.comment-editor textarea {\r\n  width: 100%;\r\n  height: 100px;\r\n  padding: 10px;\r\n  border-radius: 12px;\r\n\r\n  background: rgba(255, 255, 255, 0.65);\r\n  border: 1px solid rgba(255, 255, 255, 0.45);\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .comment-editor textarea {\r\n  background: rgba(25, 33, 31, 0.7);\r\n  border-color: rgba(80, 100, 95, 0.5);\r\n  color: #def3ed;\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .comment-editor textarea {\r\n  background: rgba(255, 245, 230, 0.75);\r\n  border-color: rgba(180, 140, 100, 0.5);\r\n  color: #3e2a15;\r\n}\r\n\r\n.editor-buttons {\r\n  display: flex;\r\n  gap: 10px;\r\n  margin-top: 10px;\r\n}\r\n\r\n.editor-buttons button {\r\n  flex: 1;\r\n  padding: 8px 12px;\r\n  border-radius: 999px;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-weight: 600;\r\n}\r\n\r\n/* AI Tag */\r\n.ai-tag-btn {\r\n  background: #ffe08a;\r\n}\r\n\r\n/* Delete */\r\n.delete-btn {\r\n  background: #ff6b6b;\r\n  color: white;\r\n}\r\n","// src/components/doc-viewer/doc-viewer.tsx\r\nimport { Component, h, Prop, State } from '@stencil/core';\r\nimport { NormalizedRect } from '../../types/annotations';\r\nimport { PageComment, AnnotationKind } from '../../types/comments';\r\nimport { HistoryManager } from '../../utils/history';\r\n\r\nconst pdfjsLib = (window as any).pdfjsLib;\r\nconst TAG_OPTIONS = ['None', 'Important', 'Todo', 'Question', 'Idea'];\r\n\r\nexport type FileType = 'pdf' | 'image' | 'text';\r\n\r\n@Component({\r\n  tag: 'doc-viewer',\r\n  styleUrl: 'doc-viewer.css',\r\n  shadow: false,\r\n})\r\nexport class DocViewer {\r\n  @Prop() src!: string;\r\n  @Prop() scale: number = 1.2;\r\n  @Prop() fileType: FileType = 'pdf';\r\n\r\n  @Prop({ mutable: true, reflect: true }) embedded: boolean = false;\r\n\r\n  @Prop({ mutable: true, reflect: true }) theme: 'light' | 'dark' | 'sepia' = 'light';\r\n  @Prop({ mutable: true, reflect: true }) mode: 'viewer' | 'editor' = 'editor';\r\n\r\n  @State() numPages = 0;\r\n  @State() activeTool: 'select' | 'highlight' | 'comment' | 'note' = 'select';\r\n\r\n  @State() annotations: Record<number, NormalizedRect[]> = {};\r\n  @State() comments: Record<number, PageComment[]> = {};\r\n\r\n  @State() sidebarOpen = false;\r\n  @State() sidebarPage: number | null = null;\r\n  @State() sidebarSelectedId: string | null = null;\r\n  @State() sidebarDraftText = '';\r\n  @State() sidebarDraftTag = 'None';\r\n\r\n  // virtual / lazy: which pages are visible\r\n  @State() visiblePages: { [page: number]: boolean } = { 1: true };\r\n\r\n  private history = new HistoryManager<{\r\n    annotations: Record<number, NormalizedRect[]>;\r\n    comments: Record<number, PageComment[]>;\r\n  }>();\r\n\r\n  private fileInputEl?: HTMLInputElement;\r\n  private intersectionObserver?: IntersectionObserver;\r\n\r\n  // ---------- STORAGE ----------\r\n  private storageKey(kind: 'annotations' | 'comments'): string {\r\n    const base = this.src || 'default';\r\n    const safe = base.replace(/[^a-z0-9]/gi, '_');\r\n    return `dv_${kind}_${safe}`;\r\n  }\r\n\r\n  private detectFileType(src: string): FileType {\r\n    const s = src.toLowerCase();\r\n    if (s.endsWith('.pdf')) return 'pdf';\r\n    if (s.match(/\\.(png|jpe?g|gif|bmp|webp)$/)) return 'image';\r\n    if (s.match(/\\.(txt|md)$/)) return 'text';\r\n    return 'text';\r\n  }\r\n\r\n  async componentDidLoad() {\r\n    const url = new URL(window.location.href);\r\n    if (url.searchParams.get('embedded') === 'true') this.embedded = true;\r\n\r\n    const ann = localStorage.getItem(this.storageKey('annotations'));\r\n    if (ann) this.annotations = JSON.parse(ann);\r\n\r\n    const cm = localStorage.getItem(this.storageKey('comments'));\r\n    if (cm) this.comments = JSON.parse(cm);\r\n\r\n    if (!this.fileType) this.fileType = this.detectFileType(this.src);\r\n\r\n    if (this.fileType === 'pdf') {\r\n      const task = pdfjsLib.getDocument(this.src);\r\n      const pdf = await task.promise;\r\n      this.numPages = pdf.numPages;\r\n    } else {\r\n      this.numPages = 1;\r\n    }\r\n\r\n    this.history.pushState({\r\n      annotations: this.annotations,\r\n      comments: this.comments,\r\n    });\r\n\r\n    this.setupIntersectionObserver();\r\n  }\r\n\r\n  private setupIntersectionObserver() {\r\n    if (typeof IntersectionObserver === 'undefined') return;\r\n\r\n    this.intersectionObserver = new IntersectionObserver(\r\n      (entries) => {\r\n        const updated = { ...this.visiblePages };\r\n        let changed = false;\r\n\r\n        for (const entry of entries) {\r\n          const el = entry.target as HTMLElement;\r\n          const pageStr = el.getAttribute('data-page');\r\n          if (!pageStr) continue;\r\n          const page = parseInt(pageStr, 10);\r\n          if (!page) continue;\r\n\r\n          if (entry.isIntersecting && !updated[page]) {\r\n            updated[page] = true;\r\n            changed = true;\r\n          }\r\n        }\r\n\r\n        if (changed) {\r\n          this.visiblePages = updated;\r\n        }\r\n      },\r\n      {\r\n        threshold: 0.2,\r\n      }\r\n    );\r\n  }\r\n\r\n  private observePageContainer = (el: HTMLElement | null, page: number) => {\r\n    if (!el || !this.intersectionObserver) return;\r\n    el.setAttribute('data-page', String(page));\r\n    this.intersectionObserver.observe(el);\r\n  };\r\n\r\n  // ===== HISTORY =====\r\n  private pushHistory() {\r\n    this.history.pushState({\r\n      annotations: this.annotations,\r\n      comments: this.comments,\r\n    });\r\n  }\r\n\r\n  private persist() {\r\n    localStorage.setItem(this.storageKey('annotations'), JSON.stringify(this.annotations));\r\n    localStorage.setItem(this.storageKey('comments'), JSON.stringify(this.comments));\r\n  }\r\n\r\n  undo = () => {\r\n    const state = this.history.undo({\r\n      annotations: this.annotations,\r\n      comments: this.comments,\r\n    });\r\n    if (!state) return;\r\n    this.annotations = state.annotations;\r\n    this.comments = state.comments;\r\n    this.persist();\r\n  };\r\n\r\n  redo = () => {\r\n    const state = this.history.redo({\r\n      annotations: this.annotations,\r\n      comments: this.comments,\r\n    });\r\n    if (!state) return;\r\n    this.annotations = state.annotations;\r\n    this.comments = state.comments;\r\n    this.persist();\r\n  };\r\n\r\n  // ===== EVENTS FROM PAGES =====\r\n  handleAnnotationCreated = (ev: CustomEvent<{ page: number; rect: NormalizedRect }>) => {\r\n    const { page, rect } = ev.detail;\r\n    this.pushHistory();\r\n\r\n    const clone = { ...this.annotations };\r\n    const list = clone[page] ? [...clone[page]] : [];\r\n    list.push(rect);\r\n    clone[page] = list;\r\n\r\n    this.annotations = clone;\r\n    this.persist();\r\n  };\r\n\r\n  handleCommentAddRequested = (\r\n    ev: CustomEvent<{ page: number; x: number; y: number; kind: AnnotationKind }>\r\n  ) => {\r\n    this.pushHistory();\r\n\r\n    const { page, x, y, kind } = ev.detail;\r\n    const id = crypto.randomUUID ? crypto.randomUUID() : Date.now().toString(36);\r\n\r\n    const updated = { ...this.comments };\r\n    const list = updated[page] ? [...updated[page]] : [];\r\n\r\n    list.push({\r\n      id,\r\n      kind,\r\n      x,\r\n      y,\r\n      text: '',\r\n      tag: 'None',\r\n      createdAt: new Date().toISOString(),\r\n    });\r\n\r\n    updated[page] = list;\r\n    this.comments = updated;\r\n    this.persist();\r\n\r\n    this.sidebarOpen = true;\r\n    this.sidebarPage = page;\r\n    this.sidebarSelectedId = id;\r\n    this.sidebarDraftText = '';\r\n    this.sidebarDraftTag = 'None';\r\n  };\r\n\r\n  handleCommentIconClicked = (ev: CustomEvent<{ page: number; commentId: string }>) => {\r\n    const { page, commentId } = ev.detail;\r\n\r\n    this.sidebarOpen = true;\r\n    this.sidebarPage = page;\r\n    this.sidebarSelectedId = commentId;\r\n\r\n    const c = this.getComment(page, commentId);\r\n    if (c) {\r\n      this.sidebarDraftText = c.text;\r\n      this.sidebarDraftTag = c.tag;\r\n    }\r\n  };\r\n\r\n  private getComment(page: number, id: string) {\r\n    const list = this.comments[page] || [];\r\n    return list.find((c) => c.id === id) || null;\r\n  }\r\n\r\n  // ===== TOOLBAR =====\r\n  setTool(tool: 'select' | 'highlight' | 'comment' | 'note') {\r\n    this.activeTool = tool;\r\n  }\r\n\r\n  // ===== SIDEBAR HELPERS =====\r\n  private getSidebarComments() {\r\n    if (!this.sidebarPage) return [];\r\n    return this.comments[this.sidebarPage] || [];\r\n  }\r\n\r\n  private selectSidebarComment(id: string) {\r\n    this.sidebarSelectedId = id;\r\n    const c = this.sidebarPage ? this.getComment(this.sidebarPage, id) : null;\r\n    if (c) {\r\n      this.sidebarDraftText = c.text;\r\n      this.sidebarDraftTag = c.tag;\r\n    }\r\n  }\r\n\r\n  saveSidebarAnnotation = () => {\r\n    if (!this.sidebarPage || !this.sidebarSelectedId) return;\r\n\r\n    this.pushHistory();\r\n\r\n    const page = this.sidebarPage;\r\n    const list = [...(this.comments[page] || [])];\r\n    const idx = list.findIndex((c) => c.id === this.sidebarSelectedId);\r\n    if (idx < 0) return;\r\n\r\n    list[idx] = {\r\n      ...list[idx],\r\n      text: this.sidebarDraftText,\r\n      tag: this.sidebarDraftTag,\r\n    };\r\n\r\n    this.comments = { ...this.comments, [page]: list };\r\n    this.persist();\r\n  };\r\n\r\n  private async mockAITag(text: string): Promise<string> {\r\n    const t = text.toLowerCase();\r\n    if (!t.trim()) return 'None';\r\n    if (t.includes('?')) return 'Question';\r\n    if (t.includes('important') || t.length > 80) return 'Important';\r\n    if (t.includes('todo') || t.includes('fix')) return 'Todo';\r\n    if (t.includes('idea')) return 'Idea';\r\n    return 'Idea';\r\n  }\r\n\r\n  deleteSidebarAnnotation = () => {\r\n    if (!this.sidebarPage || !this.sidebarSelectedId) return;\r\n\r\n    this.pushHistory();\r\n\r\n    const page = this.sidebarPage;\r\n    const list = [...(this.comments[page] || [])];\r\n\r\n    const updated = list.filter((c) => c.id !== this.sidebarSelectedId);\r\n    this.comments = { ...this.comments, [page]: updated };\r\n    this.persist();\r\n\r\n    this.sidebarSelectedId = null;\r\n    this.sidebarDraftText = '';\r\n    this.sidebarDraftTag = 'None';\r\n  };\r\n\r\n  closeSidebar = () => {\r\n    this.sidebarOpen = false;\r\n    this.sidebarPage = null;\r\n    this.sidebarSelectedId = null;\r\n    this.sidebarDraftText = '';\r\n    this.sidebarDraftTag = 'None';\r\n  };\r\n\r\n  // ===== EXPORT / IMPORT (STATE) =====\r\n  exportJson = () => {\r\n    const data = {\r\n      version: 1,\r\n      src: this.src,\r\n      fileType: this.fileType,\r\n      theme: this.theme,\r\n      mode: this.mode,\r\n      activeTool: this.activeTool,\r\n      annotations: this.annotations,\r\n      comments: this.comments,\r\n    };\r\n\r\n    const blob = new Blob([JSON.stringify(data, null, 2)], {\r\n      type: 'application/json',\r\n    });\r\n    const url = URL.createObjectURL(blob);\r\n\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'doc-viewer-state.json';\r\n    a.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  onImportFileChange = (e: Event) => {\r\n    const input = e.target as HTMLInputElement;\r\n    const file = input.files?.[0];\r\n    if (!file) return;\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = () => {\r\n      try {\r\n        const data = JSON.parse(reader.result as string);\r\n\r\n        this.pushHistory();\r\n\r\n        this.annotations = data.annotations || {};\r\n        this.comments = data.comments || {};\r\n\r\n        if (data.theme) this.theme = data.theme;\r\n        if (data.mode) this.mode = data.mode;\r\n        if (data.activeTool) this.activeTool = data.activeTool;\r\n        this.persist();\r\n      } catch {\r\n        // ignore\r\n      } finally {\r\n        input.value = '';\r\n      }\r\n    };\r\n    reader.readAsText(file);\r\n  };\r\n\r\n  // ===== SIDEBAR UI =====\r\n  renderSidebar() {\r\n    if (!this.sidebarOpen || !this.sidebarPage) return null;\r\n\r\n    const pageComments = this.getSidebarComments();\r\n    const readOnly = this.mode === 'viewer' || this.embedded;\r\n\r\n    const selected =\r\n      this.sidebarSelectedId &&\r\n      pageComments.find((c) => c.id === this.sidebarSelectedId);\r\n\r\n    return (\r\n      <div class=\"comment-sidebar\">\r\n        <div class=\"sidebar-header\">\r\n          <strong>Annotations ‚Äì Page {this.sidebarPage}</strong>\r\n          <button class=\"close-btn\" onClick={this.closeSidebar}>\r\n            ‚úï\r\n          </button>\r\n        </div>\r\n\r\n        <div class=\"comment-list\">\r\n          {pageComments.length === 0 ? (\r\n            <div class=\"empty\">No comments or notes yet.</div>\r\n          ) : (\r\n            pageComments.map((c) => (\r\n              <div\r\n                class={{\r\n                  'comment-item': true,\r\n                  selected: c.id === this.sidebarSelectedId,\r\n                }}\r\n                onClick={() => this.selectSidebarComment(c.id)}\r\n              >\r\n                <div class=\"comment-meta\">\r\n                  <span class=\"kind-pill\">{c.kind === 'comment' ? 'Comment' : 'Note'}</span>\r\n                  <span class=\"meta-time\"> ‚Ä¢ {new Date(c.createdAt).toLocaleString()}</span>\r\n                </div>\r\n                <div class=\"comment-meta tag-line\">Tag: {c.tag}</div>\r\n                <div class=\"comment-text-preview\">\r\n                  {c.text ? c.text.slice(0, 80) : '(no text yet)'}\r\n                </div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        <div class=\"comment-editor\">\r\n          {selected ? (\r\n            <>\r\n              <div class=\"editor-meta\">\r\n                Editing {selected.kind} created {new Date(selected.createdAt).toLocaleString()}\r\n              </div>\r\n\r\n              <label class=\"tag-label\">\r\n                Tag:\r\n                <select\r\n                  disabled={readOnly}\r\n                  onChange={(e: any) => (this.sidebarDraftTag = e.target.value)}\r\n                >\r\n                  {TAG_OPTIONS.map((t) => (\r\n                    <option value={t} selected={this.sidebarDraftTag === t}>\r\n                      {t}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </label>\r\n\r\n              <textarea\r\n                value={this.sidebarDraftText}\r\n                disabled={readOnly}\r\n                onInput={(e: any) => (this.sidebarDraftText = e.target.value)}\r\n                placeholder=\"Type annotation details here...\"\r\n              ></textarea>\r\n\r\n              <div class=\"editor-buttons\">\r\n                <button disabled={readOnly} onClick={this.saveSidebarAnnotation}>\r\n                  Save\r\n                </button>\r\n\r\n                <button\r\n                  class=\"ai-tag-btn\"\r\n                  disabled={readOnly}\r\n                  onClick={async () => {\r\n                    this.sidebarDraftTag = await this.mockAITag(this.sidebarDraftText);\r\n                    this.saveSidebarAnnotation();\r\n                  }}\r\n                >\r\n                  ü§ñ Auto-Tag\r\n                </button>\r\n\r\n                <button\r\n                  class=\"delete-btn\"\r\n                  disabled={readOnly}\r\n                  onClick={this.deleteSidebarAnnotation}\r\n                >\r\n                  üóë Delete\r\n                </button>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <div class=\"editor-meta\">Click a comment or note icon on the doc.</div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // ===== MAIN RENDER =====\r\n  render() {\r\n    const readOnly = this.mode === 'viewer' || this.embedded;\r\n    const pages = Array.from({ length: this.numPages || 0 }, (_, i) => i + 1);\r\n\r\n    return (\r\n      <div class={`viewer-container theme-${this.theme}`}>\r\n        {/* Toolbar hidden in embedded mode */}\r\n        {!this.embedded && (\r\n          <div class=\"toolbar\">\r\n            <button\r\n              disabled={readOnly}\r\n              class={this.activeTool === 'select' ? 'active' : ''}\r\n              onClick={() => this.setTool('select')}\r\n            >\r\n              Select\r\n            </button>\r\n            <button\r\n              disabled={readOnly}\r\n              class={this.activeTool === 'highlight' ? 'active' : ''}\r\n              onClick={() => this.setTool('highlight')}\r\n            >\r\n              Highlight\r\n            </button>\r\n            <button\r\n              disabled={readOnly}\r\n              class={this.activeTool === 'comment' ? 'active' : ''}\r\n              onClick={() => this.setTool('comment')}\r\n            >\r\n              Comment\r\n            </button>\r\n            <button\r\n              disabled={readOnly}\r\n              class={this.activeTool === 'note' ? 'active' : ''}\r\n              onClick={() => this.setTool('note')}\r\n            >\r\n              Note\r\n            </button>\r\n\r\n            <div class=\"toolbar-spacer\" />\r\n\r\n            <button disabled={readOnly} onClick={this.undo}>\r\n              ‚§∫ Undo\r\n            </button>\r\n            <button disabled={readOnly} onClick={this.redo}>\r\n              ‚§º Redo\r\n            </button>\r\n\r\n            <div class=\"toolbar-spacer\" />\r\n\r\n            <button onClick={this.exportJson}>‚¨Ü Export</button>\r\n            <button disabled={readOnly} onClick={() => this.fileInputEl?.click()}>\r\n              ‚¨á Import\r\n            </button>\r\n            <input\r\n              type=\"file\"\r\n              accept=\"application/json\"\r\n              style={{ display: 'none' }}\r\n              ref={(el) => (this.fileInputEl = el as HTMLInputElement)}\r\n              onChange={this.onImportFileChange}\r\n            />\r\n\r\n            <label>Theme:</label>\r\n            <select onChange={(e: any) => (this.theme = e.target.value)}>\r\n              <option value=\"light\" selected={this.theme === 'light'}>\r\n                Light\r\n              </option>\r\n              <option value=\"dark\" selected={this.theme === 'dark'}>\r\n                Dark\r\n              </option>\r\n              <option value=\"sepia\" selected={this.theme === 'sepia'}>\r\n                Sepia\r\n              </option>\r\n            </select>\r\n\r\n            <label>Mode:</label>\r\n            <select onChange={(e: any) => (this.mode = e.target.value)}>\r\n              <option value=\"editor\" selected={this.mode === 'editor'}>\r\n                Editor\r\n              </option>\r\n              <option value=\"viewer\" selected={this.mode === 'viewer'}>\r\n                Viewer\r\n              </option>\r\n            </select>\r\n          </div>\r\n        )}\r\n\r\n        <div class=\"viewer-main\">\r\n          <div\r\n            class={{\r\n              'pdf-panel': true,\r\n              'has-sidebar': this.sidebarOpen,\r\n            }}\r\n          >\r\n            <div class=\"pages-container\">\r\n              {pages.map((pageNum) => (\r\n                <div\r\n                  class=\"virtual-page-wrapper\"\r\n                  ref={(el) => this.observePageContainer(el as HTMLElement, pageNum)}\r\n                >\r\n                  <doc-page\r\n                    src={this.src}\r\n                    page={pageNum}\r\n                    key={pageNum}\r\n                    scale={this.scale}\r\n                    fileType={this.fileType}\r\n                    readOnly={readOnly}\r\n                    activeTool={this.activeTool}\r\n                    visible={!!this.visiblePages[pageNum]}  // ‚≠ê lazy render\r\n                    annotations={this.annotations[pageNum] || []}\r\n                    comments={this.comments[pageNum] || []}\r\n                    onAnnotationCreated={this.handleAnnotationCreated}\r\n                    onCommentAddRequested={this.handleCommentAddRequested}\r\n                    onCommentIconClicked={this.handleCommentIconClicked}\r\n                  ></doc-page>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {!this.embedded && this.renderSidebar()}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","/* ============================================\r\n   WORKSPACE ROOT ‚Äì THEMES\r\n============================================ */\r\n.workspace-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  width: 100%;\r\n  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\r\n}\r\n\r\n/* LIGHT MODE ‚Äî Pastel Glass (your first theme) */\r\n.theme-light.workspace-container {\r\n  background: linear-gradient(145deg,\r\n    #dffcf4 0%,\r\n    #eaf8ff 40%,\r\n    #f4eaff 100%\r\n  );\r\n  color: #0f1b27;\r\n}\r\n\r\n/* DARK MODE ‚Äî Matte Mint Charcoal */\r\n.theme-dark.workspace-container {\r\n  background: linear-gradient(145deg,\r\n    #0a1110 0%,\r\n    #080d0c 40%,\r\n    #050908 100%\r\n  );\r\n  color: #e9f7f4;\r\n}\r\n\r\n/* SEPIA MODE ‚Äî Soft Warm Glass */\r\n.theme-sepia.workspace-container {\r\n  background: linear-gradient(145deg,\r\n    #f8efd9 0%,\r\n    #f4e3c3 40%,\r\n    #e7ceaa 100%\r\n  );\r\n  color: #3e2a15;\r\n}\r\n\r\n/* ============================================\r\n   WORKSPACE TOOLBAR ‚Äî GLASS\r\n============================================ */\r\n.workspace-toolbar {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px 16px;\r\n  gap: 12px;\r\n\r\n  background: rgba(255, 255, 255, 0.45);\r\n  border-bottom: 1px solid rgba(255, 255, 255, 0.35);\r\n\r\n  backdrop-filter: blur(18px);\r\n  -webkit-backdrop-filter: blur(18px);\r\n  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.10);\r\n\r\n  z-index: 20;\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .workspace-toolbar {\r\n  background: rgba(20, 28, 26, 0.45);\r\n  border-bottom-color: rgba(70, 85, 80, 0.45);\r\n  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.30);\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .workspace-toolbar {\r\n  background: rgba(255, 245, 230, 0.55);\r\n  border-bottom-color: rgba(180, 140, 100, 0.45);\r\n}\r\n\r\n/* ============================================\r\n   OPEN BUTTON ‚Äî Mint Glass\r\n============================================ */\r\n.open-btn {\r\n  padding: 7px 16px;\r\n  border-radius: 999px;\r\n  border: none;\r\n\r\n  background: #0d9b82;\r\n  color: white;\r\n  cursor: pointer;\r\n\r\n  box-shadow: 0 10px 24px rgba(13, 155, 130, 0.35);\r\n  transition: 0.15s ease;\r\n}\r\n\r\n.open-btn:hover {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 12px 30px rgba(13, 155, 130, 0.45);\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .open-btn {\r\n  background: #0d9b82;\r\n  box-shadow: none;\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .open-btn {\r\n  background: #c97b43;\r\n  box-shadow: 0 10px 22px rgba(175, 110, 60, 0.45);\r\n}\r\n\r\n/* ============================================\r\n   THEME SELECT ‚Äî Glass\r\n============================================ */\r\n.theme-select {\r\n  padding: 6px 12px;\r\n  border-radius: 999px;\r\n\r\n  background: rgba(255, 255, 255, 0.65);\r\n  border: 1px solid rgba(255, 255, 255, 0.45);\r\n\r\n  backdrop-filter: blur(12px);\r\n  cursor: pointer;\r\n\r\n  font-size: 13px;\r\n  color: inherit;\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .theme-select {\r\n  background: rgba(25, 34, 32, 0.7);\r\n  border-color: rgba(100, 120, 110, 0.55);\r\n  color: #def3ed;\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .theme-select {\r\n  background: rgba(255, 245, 230, 0.75);\r\n  border-color: rgba(180, 140, 100, 0.55);\r\n  color: #3e2a15;\r\n}\r\n\r\n/* ============================================\r\n   TABS ‚Äî Glass Pills\r\n============================================ */\r\n.workspace-tabs {\r\n  display: flex;\r\n  overflow-x: auto;\r\n  gap: 6px;\r\n  padding: 6px 10px;\r\n\r\n  background: rgba(255, 255, 255, 0.30);\r\n  border-bottom: 1px solid rgba(255, 255, 255, 0.25);\r\n\r\n  backdrop-filter: blur(14px);\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .workspace-tabs {\r\n  background: rgba(25, 33, 31, 0.35);\r\n  border-bottom-color: rgba(80, 95, 90, 0.45);\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .workspace-tabs {\r\n  background: rgba(255, 245, 233, 0.55);\r\n  border-bottom-color: rgba(180, 140, 100, 0.45);\r\n}\r\n\r\n/* Individual Tab */\r\n.tab {\r\n  padding: 7px 14px;\r\n  border-radius: 12px;\r\n  cursor: pointer;\r\n\r\n  background: rgba(255, 255, 255, 0.75);\r\n  border: 1px solid rgba(255, 255, 255, 0.45);\r\n\r\n  transition: 0.15s ease;\r\n}\r\n\r\n.tab:hover {\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 10px 22px rgba(13, 155, 130, 0.15);\r\n}\r\n\r\n/* Dark */\r\n.theme-dark .tab {\r\n  background: rgba(25, 33, 31, 0.8);\r\n  border-color: rgba(80, 100, 95, 0.4);\r\n  color: #def3ed;\r\n}\r\n\r\n/* Sepia */\r\n.theme-sepia .tab {\r\n  background: rgba(255, 245, 233, 0.8);\r\n  border-color: rgba(180, 140, 100, 0.4);\r\n}\r\n\r\n/* Active Tab */\r\n.tab.active {\r\n  background: #0d9b82;\r\n  color: white;\r\n  border-color: transparent;\r\n\r\n  box-shadow: 0 10px 22px rgba(13, 155, 130, 0.35);\r\n}\r\n\r\n/* Sepia active = warm accent */\r\n.theme-sepia .tab.active {\r\n  background: #c77a42;\r\n}\r\n\r\n/* ============================================\r\n   VIEWER PANEL\r\n============================================ */\r\n.workspace-viewer {\r\n  flex: 1;\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n/* Empty message */\r\n.empty {\r\n  padding: 40px;\r\n  text-align: center;\r\n  opacity: 0.7;\r\n  font-size: 18px;\r\n}\r\n","// src/components/doc-workspace/doc-workspace.tsx\r\nimport { Component, h, Prop, State } from '@stencil/core';\r\nimport type { FileType } from '../doc-viewer/doc-viewer';\r\n\r\ninterface WorkspaceFile {\r\n  id: string;\r\n  name: string;\r\n  url: string;\r\n  fileType: FileType;\r\n}\r\n\r\n@Component({\r\n  tag: 'doc-workspace',\r\n  styleUrl: 'doc-workspace.css',\r\n  shadow: false,\r\n})\r\nexport class DocWorkspace {\r\n  @Prop() scale: number = 1.2;\r\n  @State() files: WorkspaceFile[] = [];\r\n  @State() activeId: string | null = null;\r\n\r\n  // ‚≠ê Global theme state (affects viewer + workspace)\r\n  @State() theme: 'light' | 'dark' | 'sepia' = 'light';\r\n\r\n  private fileInput?: HTMLInputElement;\r\n\r\n  // ------------------------------------------------------------\r\n  // FILE UPLOAD\r\n  // ------------------------------------------------------------\r\n  private onFileSelected = (e: Event) => {\r\n    const input = e.target as HTMLInputElement;\r\n    const file = input.files?.[0];\r\n    if (!file) return;\r\n\r\n    const ext = file.name.toLowerCase();\r\n    const id = Date.now().toString();\r\n\r\n    let fileType: FileType = 'text';\r\n    if (ext.endsWith('.pdf')) fileType = 'pdf';\r\n    else if (ext.match(/\\.(png|jpg|jpeg|gif|bmp|webp)$/)) fileType = 'image';\r\n\r\n    const url = URL.createObjectURL(file);\r\n\r\n    this.files = [\r\n      ...this.files,\r\n      {\r\n        id,\r\n        name: file.name,\r\n        url,\r\n        fileType,\r\n      },\r\n    ];\r\n\r\n    this.activeId = id;\r\n    input.value = '';\r\n  };\r\n\r\n  // ------------------------------------------------------------\r\n  // CLOSE TAB\r\n  // ------------------------------------------------------------\r\n  private closeFile(id: string) {\r\n    this.files = this.files.filter((f) => f.id !== id);\r\n\r\n    if (this.activeId === id) {\r\n      this.activeId = this.files.length ? this.files[0].id : null;\r\n    }\r\n  }\r\n\r\n  // ------------------------------------------------------------\r\n  // RENDER\r\n  // ------------------------------------------------------------\r\n  render() {\r\n    const activeFile = this.files.find((f) => f.id === this.activeId);\r\n\r\n    return (\r\n      <div class={`workspace-container theme-${this.theme}`}>\r\n\r\n        {/* ------------------------ WORKSPACE TOOLBAR ------------------------- */}\r\n        <div class=\"workspace-toolbar\">\r\n          <button class=\"open-btn\" onClick={() => this.fileInput?.click()}>\r\n            üìÇ Open File\r\n          </button>\r\n\r\n          <input\r\n            type=\"file\"\r\n            accept=\".pdf,.png,.jpg,.jpeg,.gif,.bmp,.webp,.txt,.md\"\r\n            style={{ display: 'none' }}\r\n            ref={(el) => (this.fileInput = el as HTMLInputElement)}\r\n            onChange={this.onFileSelected}\r\n          />\r\n\r\n          <div class=\"toolbar-spacer\"></div>\r\n\r\n          {/* ‚≠ê THEME SWITCHER */}\r\n          <label class=\"theme-label\">Theme:</label>\r\n          <select\r\n            class=\"theme-select\"\r\n            onChange={(e: any) => {\r\n              this.theme = e.target.value;\r\n            }}\r\n          >\r\n            <option value=\"light\" selected={this.theme === 'light'}>\r\n              Light\r\n            </option>\r\n            <option value=\"dark\" selected={this.theme === 'dark'}>\r\n              Dark\r\n            </option>\r\n            <option value=\"sepia\" selected={this.theme === 'sepia'}>\r\n              Sepia\r\n            </option>\r\n          </select>\r\n        </div>\r\n\r\n        {/* ------------------------ TABS ------------------------- */}\r\n        <div class=\"workspace-tabs\">\r\n          {this.files.map((file) => (\r\n            <div\r\n              class={{\r\n                tab: true,\r\n                active: file.id === this.activeId,\r\n              }}\r\n              onClick={() => (this.activeId = file.id)}\r\n            >\r\n              {file.name}\r\n\r\n              <span\r\n                class=\"close-x\"\r\n                onClick={(ev) => {\r\n                  ev.stopPropagation();\r\n                  this.closeFile(file.id);\r\n                }}\r\n              >\r\n                ‚úñ\r\n              </span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* ------------------------ VIEWER PANEL ------------------------- */}\r\n        <div class=\"workspace-viewer\">\r\n          {activeFile ? (\r\n            <doc-viewer\r\n              key={activeFile.id}\r\n              src={activeFile.url}\r\n              fileType={activeFile.fileType}\r\n              scale={this.scale}\r\n              theme={this.theme}      // ‚≠ê PASS THEME TO VIEWER\r\n              mode=\"editor\"           // default for workspace\r\n            ></doc-viewer>\r\n          ) : (\r\n            <div class=\"empty\">\r\n              No file opened. Click <b>Open File</b>.\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"names":["pdfjsLib"],"mappings":"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"}