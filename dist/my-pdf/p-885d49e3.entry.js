import{r as e,c as t,g as i,h as o}from"./p-C3ydJ6WH.js";const a=".page-wrapper{margin:24px auto;position:relative;width:fit-content;max-width:100%}.pdfViewerPage .page{position:relative;border-radius:16px;overflow:hidden;box-shadow:0 18px 40px rgba(0, 0, 0, 0.35);background:radial-gradient(circle at top left, #ffffff 0%, #f3f3f3 40%, #e4e4e4 100%)}.annotationLayer{position:absolute;inset:0;z-index:20;pointer-events:auto}.annotationRect{position:absolute;background:radial-gradient(circle at top left,\r\n    rgba(255, 255, 170, 0.55),\r\n    rgba(255, 210, 90, 0.35));border-radius:6px;box-shadow:0 0 0 1px rgba(255, 250, 200, 0.5),\r\n    0 0 18px rgba(255, 255, 150, 0.6);pointer-events:none}.comment-icon,.note-icon{position:absolute;font-size:18px;cursor:pointer;z-index:30;user-select:none;display:flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:999px;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);background:radial-gradient(circle at top left,\r\n    rgba(0, 180, 255, 0.9),\r\n    rgba(90, 70, 250, 0.9));box-shadow:0 6px 16px rgba(0, 0, 0, 0.35),\r\n    0 0 12px rgba(0, 184, 255, 0.7);color:#fdfdfd;transition:transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease}.note-icon{background:radial-gradient(circle at top left,\r\n    rgba(255, 140, 80, 0.95),\r\n    rgba(255, 77, 77, 0.95));box-shadow:0 6px 16px rgba(0, 0, 0, 0.35),\r\n    0 0 12px rgba(255, 130, 80, 0.8)}.comment-icon:hover,.note-icon:hover{transform:translateY(-2px) scale(1.04);box-shadow:0 10px 28px rgba(0, 0, 0, 0.45),\r\n    0 0 16px rgba(0, 200, 255, 0.9)}.virtual-page-wrapper{width:100%;display:flex;justify-content:center;margin-bottom:20px}.note-bubble{position:absolute;max-width:240px;padding:10px 14px;font-size:13px;border-radius:12px;background:rgba(255, 250, 240, 0.92);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);box-shadow:0 4px 18px rgba(0, 0, 0, 0.28),\r\n    0 0 12px rgba(255, 180, 120, 0.6);color:#4b2b1f;z-index:50;opacity:0;pointer-events:none;transform:translateY(-6px);transition:opacity 0.2s ease, transform 0.2s ease}.note-bubble.visible{opacity:1;transform:translateY(0px)}.note-bubble.left{transform:translate(-110%, -10%)}.note-bubble.right{transform:translate(32px, -10%)}.note-bubble{position:absolute;max-width:240px;padding:10px 14px;font-size:13px;border-radius:12px;background:rgba(255, 250, 240, 0.92);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);box-shadow:0 4px 18px rgba(0, 0, 0, 0.28),\r\n    0 0 12px rgba(255, 180, 120, 0.6);color:#4b2b1f;z-index:50;opacity:0;pointer-events:none;transform:translateY(-6px);transition:opacity 0.2s ease, transform 0.2s ease}.note-bubble.visible{opacity:1;transform:translateY(0px)}.note-bubble.left{transform:translate(-110%, -10%)}.note-bubble.right{transform:translate(32px, -10%)}.pdfViewerPage.select-mode .textLayer{pointer-events:auto !important}";const s=window.pdfjsLib;const r=window.pdfjsViewer;s.GlobalWorkerOptions.workerSrc="/assets/pdf.worker.js";const n=class{constructor(i){e(this,i);this.annotationCreated=t(this,"annotationCreated");this.commentAddRequested=t(this,"commentAddRequested");this.commentIconClicked=t(this,"commentIconClicked")}get host(){return i(this)}src;page;scale=1.2;fileType="pdf";activeTool="select";readOnly=false;visible=false;annotations=[];comments=[];annotationCreated;commentAddRequested;commentIconClicked;viewerContainer;annotationLayerEl=null;isDrawing=false;startX=0;startY=0;currentRectEl=null;hasRendered=false;async componentDidLoad(){await this.ensureRendered()}async visibleChanged(){await this.ensureRendered()}annotationsChanged(){this.redrawHighlightsFromProps()}commentsChanged(){this.redrawCommentsFromProps()}activeToolChanged(){this.updatePointerEvents()}readOnlyChanged(){this.updatePointerEvents()}async ensureRendered(){if(!this.visible)return;if(this.hasRendered)return;this.hasRendered=true;if(this.fileType==="image"){await this.renderImagePage()}else if(this.fileType==="text"){await this.renderTextPage()}else{await this.renderPdfPage()}}async renderPdfPage(){const e=s.getDocument(this.src);const t=await e.promise;const i=await t.getPage(this.page);const o=i.getViewport({scale:this.scale});const a=new r.EventBus;const n=new r.PDFPageView({container:this.viewerContainer,id:this.page,scale:this.scale,defaultViewport:o,eventBus:a,textLayerMode:2});n.setPdfPage(i);await n.draw();const c=n.div;const d=()=>{this.setupAnnotationLayer(c);this.redrawHighlightsFromProps();this.redrawCommentsFromProps()};requestAnimationFrame((()=>{requestAnimationFrame(d)}))}async renderImagePage(){const e=document.createElement("div");e.classList.add("page");e.style.position="relative";this.viewerContainer.appendChild(e);const t=document.createElement("img");t.src=this.src;t.style.display="block";t.style.maxWidth=`${800*this.scale}px`;e.appendChild(t);t.onload=()=>{this.setupAnnotationLayer(e);this.redrawHighlightsFromProps();this.redrawCommentsFromProps()}}async renderTextPage(){const e=document.createElement("div");e.classList.add("page");e.style.position="relative";this.viewerContainer.appendChild(e);const t=document.createElement("pre");t.classList.add("text-content");t.style.fontSize=`${16*this.scale}px`;t.style.whiteSpace="pre-wrap";const i=await fetch(this.src).then((e=>e.text()));t.textContent=i;e.appendChild(t);this.setupAnnotationLayer(e);this.redrawHighlightsFromProps();this.redrawCommentsFromProps();t.addEventListener("mouseup",(()=>this.handleTextMouseUp()))}setupAnnotationLayer(e){const t=e.querySelector(".annotationLayer");if(t)t.remove();const i=document.createElement("div");i.classList.add("annotationLayer");Object.assign(i.style,{position:"absolute",inset:"0",zIndex:"999",pointerEvents:"auto"});this.annotationLayerEl=i;e.appendChild(i);if(!this.readOnly){i.addEventListener("mousedown",(e=>this.onMouseDown(e)));i.addEventListener("mousemove",(e=>this.onMouseMove(e)));i.addEventListener("mouseup",(()=>this.onMouseUp()))}this.updatePointerEvents()}updatePointerEvents(){if(!this.annotationLayerEl)return;const e=this.annotationLayerEl;if(this.readOnly){e.style.pointerEvents="none";e.querySelectorAll(".comment-icon, .note-icon").forEach((e=>e.style.pointerEvents="auto"));return}if(this.fileType==="text"){if(this.activeTool==="highlight"||this.activeTool==="select"){e.style.pointerEvents="none"}else{e.style.pointerEvents="auto"}}else{if(this.activeTool==="select"){e.style.pointerEvents="none"}else{e.style.pointerEvents="auto"}}e.querySelectorAll(".comment-icon, .note-icon").forEach((e=>e.style.pointerEvents="auto"))}onMouseDown(e){if(!this.annotationLayerEl||this.readOnly)return;const t=this.annotationLayerEl.getBoundingClientRect();if(!t.width||!t.height)return;if(this.activeTool==="comment"||this.activeTool==="note"){const i=(e.clientX-t.left)/t.width;const o=(e.clientY-t.top)/t.height;this.commentAddRequested.emit({page:this.page,x:i,y:o,kind:this.activeTool==="comment"?"comment":"note"});return}if(this.activeTool!=="highlight"||this.fileType==="text")return;this.isDrawing=true;this.startX=e.clientX-t.left;this.startY=e.clientY-t.top;this.currentRectEl=document.createElement("div");this.currentRectEl.className="annotationRect";this.currentRectEl.style.left=`${this.startX}px`;this.currentRectEl.style.top=`${this.startY}px`;this.annotationLayerEl.appendChild(this.currentRectEl)}onMouseMove(e){if(this.readOnly)return;if(!this.isDrawing||!this.currentRectEl||!this.annotationLayerEl)return;const t=this.annotationLayerEl.getBoundingClientRect();if(!t.width||!t.height)return;const i=e.clientX-t.left;const o=e.clientY-t.top;this.currentRectEl.style.width=`${i-this.startX}px`;this.currentRectEl.style.height=`${o-this.startY}px`}onMouseUp(){if(this.readOnly)return;if(!this.isDrawing||!this.annotationLayerEl||!this.currentRectEl)return;this.isDrawing=false;const e=this.annotationLayerEl.getBoundingClientRect();const t=parseFloat(this.currentRectEl.style.width||"0");const i=parseFloat(this.currentRectEl.style.height||"0");if(t>3&&i>3&&e.width&&e.height){const o={x:parseFloat(this.currentRectEl.style.left||"0")/e.width,y:parseFloat(this.currentRectEl.style.top||"0")/e.height,width:t/e.width,height:i/e.height};this.annotationCreated.emit({page:this.page,rect:o})}this.currentRectEl.remove();this.currentRectEl=null}handleTextMouseUp(){if(this.readOnly)return;if(this.fileType!=="text")return;if(this.activeTool!=="highlight")return;if(!this.annotationLayerEl)return;const e=window.getSelection();if(!e||e.isCollapsed)return;const t=e.getRangeAt(0);const i=t.getBoundingClientRect();e.removeAllRanges();const o=this.annotationLayerEl.getBoundingClientRect();if(!o.width||!o.height||!i.width||!i.height)return;const a=i.left-o.left;const s=i.top-o.top;const r={x:a/o.width,y:s/o.height,width:i.width/o.width,height:i.height/o.height};const n=document.createElement("div");n.className="annotationRect";n.style.left=`${a}px`;n.style.top=`${s}px`;n.style.width=`${i.width}px`;n.style.height=`${i.height}px`;this.annotationLayerEl.appendChild(n);this.annotationCreated.emit({page:this.page,rect:r})}redrawHighlightsFromProps(){if(!this.annotationLayerEl)return;this.annotationLayerEl.querySelectorAll(".annotationRect").forEach((e=>e.remove()));const e=this.annotationLayerEl.getBoundingClientRect();if(!e.width||!e.height)return;this.annotations.forEach((t=>{const i=document.createElement("div");i.className="annotationRect";i.style.left=`${t.x*e.width}px`;i.style.top=`${t.y*e.height}px`;i.style.width=`${t.width*e.width}px`;i.style.height=`${t.height*e.height}px`;this.annotationLayerEl.appendChild(i)}));this.updatePointerEvents()}redrawCommentsFromProps(){if(!this.annotationLayerEl)return;this.annotationLayerEl.querySelectorAll(".comment-icon, .note-icon, .note-bubble").forEach((e=>e.remove()));const e=this.annotationLayerEl.getBoundingClientRect();if(!e.width||!e.height)return;this.comments.forEach((t=>{const i=t.kind==="note";const o=t.x*e.width;const a=t.y*e.height;const s=document.createElement("div");s.className=i?"note-icon":"comment-icon";s.textContent=i?"ðŸ“":"ðŸ’¬";s.style.left=`${o}px`;s.style.top=`${a}px`;if(!i){s.addEventListener("click",(e=>{e.stopPropagation();this.commentIconClicked.emit({page:this.page,commentId:t.id})}));this.annotationLayerEl.appendChild(s);return}const r=document.createElement("div");r.className="note-bubble";r.textContent=t.text&&t.text.trim()!==""?t.text:"(empty note)";r.style.left=`${o}px`;r.style.top=`${a}px`;const n=o<e.width*.6;r.classList.add(n?"right":"left");s.addEventListener("mouseenter",(()=>{r.classList.add("visible")}));s.addEventListener("mouseleave",(()=>{r.classList.remove("visible")}));s.addEventListener("click",(e=>{e.stopPropagation();r.classList.toggle("visible");this.commentIconClicked.emit({page:this.page,commentId:t.id})}));this.annotationLayerEl.appendChild(r);this.annotationLayerEl.appendChild(s)}));this.updatePointerEvents()}render(){return o("div",{key:"c66d3053eb9f0aee149287d428fb7bfd0f6579c2",class:"page-wrapper"},o("div",{key:"bbe543561da64798a590abfcb7aaad5dfa4bfe45",class:"pdfViewerPage",ref:e=>this.viewerContainer=e}))}static get watchers(){return{visible:["visibleChanged"],annotations:["annotationsChanged"],comments:["commentsChanged"],activeTool:["activeToolChanged"],readOnly:["readOnlyChanged"]}}};n.style=a;class c{past=[];future=[];clone(e){return JSON.parse(JSON.stringify(e))}pushState(e){this.past.push(this.clone(e));this.future=[]}undo(e){if(this.past.length===0)return null;const t=this.past.pop();this.future.push(this.clone(e));return t}redo(e){if(this.future.length===0)return null;const t=this.future.pop();this.past.push(this.clone(e));return t}}const d=".viewer-container{--toolbar-height:56px;--bg-light:linear-gradient(145deg,\r\n    #dffcf4 0%,\r\n    #eaf8ff 40%,\r\n    #f4eaff 100%\r\n  );--text-light:#0f1b27;--bg-dark:linear-gradient(145deg,\r\n    #0a1110 0%,\r\n    #080d0c 40%,\r\n    #050908 100%\r\n  );--text-dark:#e8f6f3;--bg-sepia:linear-gradient(145deg,\r\n    #f8efd9 0%,\r\n    #f4e3c3 40%,\r\n    #e7ceaa 100%\r\n  );--text-sepia:#3e2a15}.viewer-container{display:flex;flex-direction:column;height:100%;width:100%;overflow:hidden;background:var(--bg-light);color:var(--text-light)}.viewer-container.theme-dark{background:var(--bg-dark);color:var(--text-dark)}.viewer-container.theme-sepia{background:var(--bg-sepia);color:var(--text-sepia)}.toolbar{height:var(--toolbar-height);display:flex;align-items:center;gap:12px;padding:10px 18px;background:rgba(255, 255, 255, 0.45);border-bottom:1px solid rgba(255, 255, 255, 0.35);backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px);box-shadow:0 8px 22px rgba(0, 0, 0, 0.08);position:sticky;top:0;z-index:100}.theme-dark .toolbar{background:rgba(25, 33, 31, 0.5);border-bottom-color:rgba(80, 100, 95, 0.5);box-shadow:0 8px 18px rgba(0, 0, 0, 0.25)}.theme-sepia .toolbar{background:rgba(255, 245, 230, 0.55);border-bottom-color:rgba(180, 140, 100, 0.4)}.toolbar button,.toolbar select{padding:6px 14px;border-radius:999px;background:rgba(255, 255, 255, 0.65);border:1px solid rgba(255, 255, 255, 0.45);backdrop-filter:blur(12px);cursor:pointer;font-size:14px}.theme-dark .toolbar button,.theme-dark .toolbar select{background:rgba(22, 30, 28, 0.7);border-color:rgba(100, 120, 110, 0.6);color:#e9f7f4}.theme-sepia .toolbar button,.theme-sepia .toolbar select{background:rgba(255, 245, 230, 0.75);border-color:rgba(180, 140, 100, 0.55);color:#3d2a15}.toolbar button.active{background:#0d9b82;color:white;border-color:transparent;box-shadow:0 10px 24px rgba(13, 155, 130, 0.35)}.theme-sepia .toolbar button.active{background:#c77a42;box-shadow:0 10px 22px rgba(175, 110, 60, 0.35)}.viewer-main{display:flex;flex:1;overflow:hidden;height:calc(100vh - var(--toolbar-height))}.pdf-panel{flex:1;overflow-y:auto;padding:24px;display:flex;justify-content:center;align-items:flex-start;transition:margin-right 0.25s ease}.pdf-panel.has-sidebar{margin-right:330px}.pages-container{display:flex;flex-direction:column;align-items:center;gap:28px;width:100%}.comment-sidebar{width:330px;height:calc(100vh - var(--toolbar-height));position:fixed;right:0;top:var(--toolbar-height);overflow-y:auto;padding-bottom:16px;background:rgba(255, 255, 255, 0.55);border-left:1px solid rgba(255, 255, 255, 0.35);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);box-shadow:-8px 0 18px rgba(0, 0, 0, 0.15);z-index:200}.theme-dark .comment-sidebar{background:rgba(25, 33, 31, 0.55);border-left-color:rgba(80, 100, 95, 0.4);box-shadow:-8px 0 18px rgba(0, 0, 0, 0.32);color:#e8f6f3}.theme-sepia .comment-sidebar{background:rgba(255, 245, 230, 0.65);border-left-color:rgba(180, 140, 100, 0.45)}.sidebar-header{padding:16px;font-weight:600;font-size:15px;border-bottom:1px solid rgba(255, 255, 255, 0.35)}.theme-dark .sidebar-header{border-bottom-color:rgba(100, 120, 110, 0.35)}.theme-sepia .sidebar-header{border-bottom-color:rgba(180, 140, 100, 0.35)}.comment-list{padding:12px}.comment-item{padding:12px;border-radius:14px;background:rgba(255, 255, 255, 0.75);border:1px solid transparent;cursor:pointer;transition:0.15s ease}.comment-item:hover{transform:translateY(-2px);box-shadow:0 8px 18px rgba(13, 155, 130, 0.18)}.comment-item.selected{border-color:#0d9b82;background:#e1f8f3;box-shadow:0 10px 22px rgba(13, 155, 130, 0.25)}.theme-dark .comment-item.selected{background:rgba(30, 45, 42, 0.8);border-color:#0d9b82}.theme-sepia .comment-item.selected{background:#f5e7d2;border-color:#c77a42}.comment-editor{padding:14px;border-top:1px solid rgba(255, 255, 255, 0.35)}.theme-dark .comment-editor{border-top-color:rgba(100, 120, 110, 0.35)}.theme-sepia .comment-editor{border-top-color:rgba(180, 140, 100, 0.4)}.comment-editor textarea{width:100%;height:100px;padding:10px;border-radius:12px;background:rgba(255, 255, 255, 0.65);border:1px solid rgba(255, 255, 255, 0.45)}.theme-dark .comment-editor textarea{background:rgba(25, 33, 31, 0.7);border-color:rgba(80, 100, 95, 0.5);color:#def3ed}.theme-sepia .comment-editor textarea{background:rgba(255, 245, 230, 0.75);border-color:rgba(180, 140, 100, 0.5);color:#3e2a15}.editor-buttons{display:flex;gap:10px;margin-top:10px}.editor-buttons button{flex:1;padding:8px 12px;border-radius:999px;border:none;cursor:pointer;font-weight:600}.ai-tag-btn{background:#ffe08a}.delete-btn{background:#ff6b6b;color:white}";const b=window.pdfjsLib;const h=["None","Important","Todo","Question","Idea"];const l=class{constructor(t){e(this,t)}src;scale=1.2;fileType="pdf";embedded=false;theme="light";mode="editor";numPages=0;activeTool="select";annotations={};comments={};sidebarOpen=false;sidebarPage=null;sidebarSelectedId=null;sidebarDraftText="";sidebarDraftTag="None";visiblePages={1:true};history=new c;fileInputEl;intersectionObserver;storageKey(e){const t=this.src||"default";const i=t.replace(/[^a-z0-9]/gi,"_");return`dv_${e}_${i}`}detectFileType(e){const t=e.toLowerCase();if(t.endsWith(".pdf"))return"pdf";if(t.match(/\.(png|jpe?g|gif|bmp|webp)$/))return"image";if(t.match(/\.(txt|md)$/))return"text";return"text"}async componentDidLoad(){const e=new URL(window.location.href);if(e.searchParams.get("embedded")==="true")this.embedded=true;const t=localStorage.getItem(this.storageKey("annotations"));if(t)this.annotations=JSON.parse(t);const i=localStorage.getItem(this.storageKey("comments"));if(i)this.comments=JSON.parse(i);if(!this.fileType)this.fileType=this.detectFileType(this.src);if(this.fileType==="pdf"){const e=b.getDocument(this.src);const t=await e.promise;this.numPages=t.numPages}else{this.numPages=1}this.history.pushState({annotations:this.annotations,comments:this.comments});this.setupIntersectionObserver()}setupIntersectionObserver(){if(typeof IntersectionObserver==="undefined")return;this.intersectionObserver=new IntersectionObserver((e=>{const t={...this.visiblePages};let i=false;for(const o of e){const e=o.target;const a=e.getAttribute("data-page");if(!a)continue;const s=parseInt(a,10);if(!s)continue;if(o.isIntersecting&&!t[s]){t[s]=true;i=true}}if(i){this.visiblePages=t}}),{threshold:.2})}observePageContainer=(e,t)=>{if(!e||!this.intersectionObserver)return;e.setAttribute("data-page",String(t));this.intersectionObserver.observe(e)};pushHistory(){this.history.pushState({annotations:this.annotations,comments:this.comments})}persist(){localStorage.setItem(this.storageKey("annotations"),JSON.stringify(this.annotations));localStorage.setItem(this.storageKey("comments"),JSON.stringify(this.comments))}undo=()=>{const e=this.history.undo({annotations:this.annotations,comments:this.comments});if(!e)return;this.annotations=e.annotations;this.comments=e.comments;this.persist()};redo=()=>{const e=this.history.redo({annotations:this.annotations,comments:this.comments});if(!e)return;this.annotations=e.annotations;this.comments=e.comments;this.persist()};handleAnnotationCreated=e=>{const{page:t,rect:i}=e.detail;this.pushHistory();const o={...this.annotations};const a=o[t]?[...o[t]]:[];a.push(i);o[t]=a;this.annotations=o;this.persist()};handleCommentAddRequested=e=>{this.pushHistory();const{page:t,x:i,y:o,kind:a}=e.detail;const s=crypto.randomUUID?crypto.randomUUID():Date.now().toString(36);const r={...this.comments};const n=r[t]?[...r[t]]:[];n.push({id:s,kind:a,x:i,y:o,text:"",tag:"None",createdAt:(new Date).toISOString()});r[t]=n;this.comments=r;this.persist();this.sidebarOpen=true;this.sidebarPage=t;this.sidebarSelectedId=s;this.sidebarDraftText="";this.sidebarDraftTag="None"};handleCommentIconClicked=e=>{const{page:t,commentId:i}=e.detail;this.sidebarOpen=true;this.sidebarPage=t;this.sidebarSelectedId=i;const o=this.getComment(t,i);if(o){this.sidebarDraftText=o.text;this.sidebarDraftTag=o.tag}};getComment(e,t){const i=this.comments[e]||[];return i.find((e=>e.id===t))||null}setTool(e){this.activeTool=e}getSidebarComments(){if(!this.sidebarPage)return[];return this.comments[this.sidebarPage]||[]}selectSidebarComment(e){this.sidebarSelectedId=e;const t=this.sidebarPage?this.getComment(this.sidebarPage,e):null;if(t){this.sidebarDraftText=t.text;this.sidebarDraftTag=t.tag}}saveSidebarAnnotation=()=>{if(!this.sidebarPage||!this.sidebarSelectedId)return;this.pushHistory();const e=this.sidebarPage;const t=[...this.comments[e]||[]];const i=t.findIndex((e=>e.id===this.sidebarSelectedId));if(i<0)return;t[i]={...t[i],text:this.sidebarDraftText,tag:this.sidebarDraftTag};this.comments={...this.comments,[e]:t};this.persist()};async mockAITag(e){const t=e.toLowerCase();if(!t.trim())return"None";if(t.includes("?"))return"Question";if(t.includes("important")||t.length>80)return"Important";if(t.includes("todo")||t.includes("fix"))return"Todo";if(t.includes("idea"))return"Idea";return"Idea"}deleteSidebarAnnotation=()=>{if(!this.sidebarPage||!this.sidebarSelectedId)return;this.pushHistory();const e=this.sidebarPage;const t=[...this.comments[e]||[]];const i=t.filter((e=>e.id!==this.sidebarSelectedId));this.comments={...this.comments,[e]:i};this.persist();this.sidebarSelectedId=null;this.sidebarDraftText="";this.sidebarDraftTag="None"};closeSidebar=()=>{this.sidebarOpen=false;this.sidebarPage=null;this.sidebarSelectedId=null;this.sidebarDraftText="";this.sidebarDraftTag="None"};exportJson=()=>{const e={version:1,src:this.src,fileType:this.fileType,theme:this.theme,mode:this.mode,activeTool:this.activeTool,annotations:this.annotations,comments:this.comments};const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});const i=URL.createObjectURL(t);const o=document.createElement("a");o.href=i;o.download="doc-viewer-state.json";o.click();URL.revokeObjectURL(i)};onImportFileChange=e=>{const t=e.target;const i=t.files?.[0];if(!i)return;const o=new FileReader;o.onload=()=>{try{const e=JSON.parse(o.result);this.pushHistory();this.annotations=e.annotations||{};this.comments=e.comments||{};if(e.theme)this.theme=e.theme;if(e.mode)this.mode=e.mode;if(e.activeTool)this.activeTool=e.activeTool;this.persist()}catch{}finally{t.value=""}};o.readAsText(i)};renderSidebar(){if(!this.sidebarOpen||!this.sidebarPage)return null;const e=this.getSidebarComments();const t=this.mode==="viewer"||this.embedded;const i=this.sidebarSelectedId&&e.find((e=>e.id===this.sidebarSelectedId));return o("div",{class:"comment-sidebar"},o("div",{class:"sidebar-header"},o("strong",null,"Annotations â€“ Page ",this.sidebarPage),o("button",{class:"close-btn",onClick:this.closeSidebar},"âœ•")),o("div",{class:"comment-list"},e.length===0?o("div",{class:"empty"},"No comments or notes yet."):e.map((e=>o("div",{class:{"comment-item":true,selected:e.id===this.sidebarSelectedId},onClick:()=>this.selectSidebarComment(e.id)},o("div",{class:"comment-meta"},o("span",{class:"kind-pill"},e.kind==="comment"?"Comment":"Note"),o("span",{class:"meta-time"}," â€¢ ",new Date(e.createdAt).toLocaleString())),o("div",{class:"comment-meta tag-line"},"Tag: ",e.tag),o("div",{class:"comment-text-preview"},e.text?e.text.slice(0,80):"(no text yet)"))))),o("div",{class:"comment-editor"},i?o(o.Fragment,null,o("div",{class:"editor-meta"},"Editing ",i.kind," created ",new Date(i.createdAt).toLocaleString()),o("label",{class:"tag-label"},"Tag:",o("select",{disabled:t,onChange:e=>this.sidebarDraftTag=e.target.value},h.map((e=>o("option",{value:e,selected:this.sidebarDraftTag===e},e))))),o("textarea",{value:this.sidebarDraftText,disabled:t,onInput:e=>this.sidebarDraftText=e.target.value,placeholder:"Type annotation details here..."}),o("div",{class:"editor-buttons"},o("button",{disabled:t,onClick:this.saveSidebarAnnotation},"Save"),o("button",{class:"ai-tag-btn",disabled:t,onClick:async()=>{this.sidebarDraftTag=await this.mockAITag(this.sidebarDraftText);this.saveSidebarAnnotation()}},"ðŸ¤– Auto-Tag"),o("button",{class:"delete-btn",disabled:t,onClick:this.deleteSidebarAnnotation},"ðŸ—‘ Delete"))):o("div",{class:"editor-meta"},"Click a comment or note icon on the doc.")))}render(){const e=this.mode==="viewer"||this.embedded;const t=Array.from({length:this.numPages||0},((e,t)=>t+1));return o("div",{key:"223069720ac91636227a6a33069a1afbe7abdf2e",class:`viewer-container theme-${this.theme}`},!this.embedded&&o("div",{key:"5ef94daff315d0347db65261fdb93f597902048d",class:"toolbar"},o("button",{key:"7bfbcc711d5a62ff7b1a5df9e113b76b2bedf1f9",disabled:e,class:this.activeTool==="select"?"active":"",onClick:()=>this.setTool("select")},"Select"),o("button",{key:"cf2613b858e8c581f99159758850e722522b953e",disabled:e,class:this.activeTool==="highlight"?"active":"",onClick:()=>this.setTool("highlight")},"Highlight"),o("button",{key:"cb86bcb6622c3ffa9daa878e2a40d66244420281",disabled:e,class:this.activeTool==="comment"?"active":"",onClick:()=>this.setTool("comment")},"Comment"),o("button",{key:"56ca7c23e4d339c663a09098282279a03d856d5a",disabled:e,class:this.activeTool==="note"?"active":"",onClick:()=>this.setTool("note")},"Note"),o("div",{key:"4a98f6db2a15b5e0c52f586b344be406ad071d37",class:"toolbar-spacer"}),o("button",{key:"7a574acb41a8c3db81d31325f3bc6bb926a80aa7",disabled:e,onClick:this.undo},"â¤º Undo"),o("button",{key:"d4bb6113e31041b52e5c18aa1cfa23f2606c8a90",disabled:e,onClick:this.redo},"â¤¼ Redo"),o("div",{key:"8d359e25665d72d2d046916aa7df97607f493ae8",class:"toolbar-spacer"}),o("button",{key:"5bd424113a03f321d78adadd524416cfe9bdbf9f",onClick:this.exportJson},"â¬† Export"),o("button",{key:"642033dbcacdd6076e4f4905eceb28b3fdc1aec2",disabled:e,onClick:()=>this.fileInputEl?.click()},"â¬‡ Import"),o("input",{key:"8e83a854e66fca389fb45dfe9b6dea0494de4e8f",type:"file",accept:"application/json",style:{display:"none"},ref:e=>this.fileInputEl=e,onChange:this.onImportFileChange}),o("label",{key:"f3fb274f9c1ceacff2d5b2b3f72a5c812590ab6d"},"Theme:"),o("select",{key:"c9a01eea00d6a6eaf8b1ea5a81e801b469a52d38",onChange:e=>this.theme=e.target.value},o("option",{key:"e7be10f8e778afe989ae8ac8839a393215aa85b8",value:"light",selected:this.theme==="light"},"Light"),o("option",{key:"dc4b07530a737a3cedb5d77b0e93721f2d1fece2",value:"dark",selected:this.theme==="dark"},"Dark"),o("option",{key:"191782ace171d381600a523c0b2ef68b0674995d",value:"sepia",selected:this.theme==="sepia"},"Sepia")),o("label",{key:"72f7bb2dad4adade8378e3961f9b6c48435b3b37"},"Mode:"),o("select",{key:"9f2b4ed099bbe61aca1daa8c2eac097c69dd9b7b",onChange:e=>this.mode=e.target.value},o("option",{key:"765a980587716ed7f37f0081cb600443e53fab5b",value:"editor",selected:this.mode==="editor"},"Editor"),o("option",{key:"a7e5e6b11d88c74f10d47af5687d8442d581f191",value:"viewer",selected:this.mode==="viewer"},"Viewer"))),o("div",{key:"56284ffda518bbdb201ca2be2ec233d205ba4396",class:"viewer-main"},o("div",{key:"1c81e83ade1da038adef7e53936ecfc90976a21e",class:{"pdf-panel":true,"has-sidebar":this.sidebarOpen}},o("div",{key:"f06332e958946313e6af80c72e70049043136d69",class:"pages-container"},t.map((t=>o("div",{class:"virtual-page-wrapper",ref:e=>this.observePageContainer(e,t)},o("doc-page",{src:this.src,page:t,key:t,scale:this.scale,fileType:this.fileType,readOnly:e,activeTool:this.activeTool,visible:!!this.visiblePages[t],annotations:this.annotations[t]||[],comments:this.comments[t]||[],onAnnotationCreated:this.handleAnnotationCreated,onCommentAddRequested:this.handleCommentAddRequested,onCommentIconClicked:this.handleCommentIconClicked})))))),!this.embedded&&this.renderSidebar()))}};l.style=d;const p=".workspace-container{display:flex;flex-direction:column;height:100%;width:100%;font-family:system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif}.theme-light.workspace-container{background:linear-gradient(145deg,\r\n    #dffcf4 0%,\r\n    #eaf8ff 40%,\r\n    #f4eaff 100%\r\n  );color:#0f1b27}.theme-dark.workspace-container{background:linear-gradient(145deg,\r\n    #0a1110 0%,\r\n    #080d0c 40%,\r\n    #050908 100%\r\n  );color:#e9f7f4}.theme-sepia.workspace-container{background:linear-gradient(145deg,\r\n    #f8efd9 0%,\r\n    #f4e3c3 40%,\r\n    #e7ceaa 100%\r\n  );color:#3e2a15}.workspace-toolbar{display:flex;align-items:center;padding:10px 16px;gap:12px;background:rgba(255, 255, 255, 0.45);border-bottom:1px solid rgba(255, 255, 255, 0.35);backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px);box-shadow:0 8px 22px rgba(0, 0, 0, 0.10);z-index:20}.theme-dark .workspace-toolbar{background:rgba(20, 28, 26, 0.45);border-bottom-color:rgba(70, 85, 80, 0.45);box-shadow:0 8px 22px rgba(0, 0, 0, 0.30)}.theme-sepia .workspace-toolbar{background:rgba(255, 245, 230, 0.55);border-bottom-color:rgba(180, 140, 100, 0.45)}.open-btn{padding:7px 16px;border-radius:999px;border:none;background:#0d9b82;color:white;cursor:pointer;box-shadow:0 10px 24px rgba(13, 155, 130, 0.35);transition:0.15s ease}.open-btn:hover{transform:translateY(-2px);box-shadow:0 12px 30px rgba(13, 155, 130, 0.45)}.theme-dark .open-btn{background:#0d9b82;box-shadow:none}.theme-sepia .open-btn{background:#c97b43;box-shadow:0 10px 22px rgba(175, 110, 60, 0.45)}.theme-select{padding:6px 12px;border-radius:999px;background:rgba(255, 255, 255, 0.65);border:1px solid rgba(255, 255, 255, 0.45);backdrop-filter:blur(12px);cursor:pointer;font-size:13px;color:inherit}.theme-dark .theme-select{background:rgba(25, 34, 32, 0.7);border-color:rgba(100, 120, 110, 0.55);color:#def3ed}.theme-sepia .theme-select{background:rgba(255, 245, 230, 0.75);border-color:rgba(180, 140, 100, 0.55);color:#3e2a15}.workspace-tabs{display:flex;overflow-x:auto;gap:6px;padding:6px 10px;background:rgba(255, 255, 255, 0.30);border-bottom:1px solid rgba(255, 255, 255, 0.25);backdrop-filter:blur(14px)}.theme-dark .workspace-tabs{background:rgba(25, 33, 31, 0.35);border-bottom-color:rgba(80, 95, 90, 0.45)}.theme-sepia .workspace-tabs{background:rgba(255, 245, 233, 0.55);border-bottom-color:rgba(180, 140, 100, 0.45)}.tab{padding:7px 14px;border-radius:12px;cursor:pointer;background:rgba(255, 255, 255, 0.75);border:1px solid rgba(255, 255, 255, 0.45);transition:0.15s ease}.tab:hover{transform:translateY(-2px);box-shadow:0 10px 22px rgba(13, 155, 130, 0.15)}.theme-dark .tab{background:rgba(25, 33, 31, 0.8);border-color:rgba(80, 100, 95, 0.4);color:#def3ed}.theme-sepia .tab{background:rgba(255, 245, 233, 0.8);border-color:rgba(180, 140, 100, 0.4)}.tab.active{background:#0d9b82;color:white;border-color:transparent;box-shadow:0 10px 22px rgba(13, 155, 130, 0.35)}.theme-sepia .tab.active{background:#c77a42}.workspace-viewer{flex:1;overflow:hidden;position:relative}.empty{padding:40px;text-align:center;opacity:0.7;font-size:18px}";const f=class{constructor(t){e(this,t)}scale=1.2;files=[];activeId=null;theme="light";fileInput;onFileSelected=e=>{const t=e.target;const i=t.files?.[0];if(!i)return;const o=i.name.toLowerCase();const a=Date.now().toString();let s="text";if(o.endsWith(".pdf"))s="pdf";else if(o.match(/\.(png|jpg|jpeg|gif|bmp|webp)$/))s="image";const r=URL.createObjectURL(i);this.files=[...this.files,{id:a,name:i.name,url:r,fileType:s}];this.activeId=a;t.value=""};closeFile(e){this.files=this.files.filter((t=>t.id!==e));if(this.activeId===e){this.activeId=this.files.length?this.files[0].id:null}}render(){const e=this.files.find((e=>e.id===this.activeId));return o("div",{key:"1fe9a7de7abb1d3f694bd757ac638b709677327c",class:`workspace-container theme-${this.theme}`},o("div",{key:"d6a3873178e1b4f2068e3342bd45db031b06cd12",class:"workspace-toolbar"},o("button",{key:"2f1e333c61ac0fd18f6f03fb0b306dab7a26e385",class:"open-btn",onClick:()=>this.fileInput?.click()},"ðŸ“‚ Open File"),o("input",{key:"ea9daeb88184063b7d5c2075ec59979094cacfa9",type:"file",accept:".pdf,.png,.jpg,.jpeg,.gif,.bmp,.webp,.txt,.md",style:{display:"none"},ref:e=>this.fileInput=e,onChange:this.onFileSelected}),o("div",{key:"5fefbf76312251ebd641af0358bc5762a0309e55",class:"toolbar-spacer"}),o("label",{key:"d7e9206aa459270475b0c01b29cec4c0c89cdae1",class:"theme-label"},"Theme:"),o("select",{key:"86e27cc8a67fe702a51bf9d2d595aaacb7cb50b6",class:"theme-select",onChange:e=>{this.theme=e.target.value}},o("option",{key:"b80c6cbe732d0d0602901e95d5127ace554db2c0",value:"light",selected:this.theme==="light"},"Light"),o("option",{key:"94b284488b10ee8ff1bac868a953877565391a16",value:"dark",selected:this.theme==="dark"},"Dark"),o("option",{key:"0f65f78f34bf6e5c2ff3c34367310aca0bb9934c",value:"sepia",selected:this.theme==="sepia"},"Sepia"))),o("div",{key:"30d0c57310f183618b069f56315493cb6de43a3c",class:"workspace-tabs"},this.files.map((e=>o("div",{class:{tab:true,active:e.id===this.activeId},onClick:()=>this.activeId=e.id},e.name,o("span",{class:"close-x",onClick:t=>{t.stopPropagation();this.closeFile(e.id)}},"âœ–"))))),o("div",{key:"2d6c9175ecf8e96bfc2719375337efe1bce9fda0",class:"workspace-viewer"},e?o("doc-viewer",{key:e.id,src:e.url,fileType:e.fileType,scale:this.scale,theme:this.theme,mode:"editor"}):o("div",{class:"empty"},"No file opened. Click ",o("b",null,"Open File"),".")))}};f.style=p;export{n as doc_page,l as doc_viewer,f as doc_workspace};
//# sourceMappingURL=p-885d49e3.entry.js.map